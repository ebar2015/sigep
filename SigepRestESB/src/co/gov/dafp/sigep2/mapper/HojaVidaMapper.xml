<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.gov.dafp.sigep2.interfaces.HojaVidaMapper">
  <resultMap id="BaseResultMap" type="co.gov.dafp.sigep2.bean.HojaVida">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    <result column="COD_HOJA_VIDA" jdbcType="NUMERIC" property="codHojaVida" />
    <result column="COD_PERSONA" jdbcType="NUMERIC" property="codPersona" />
    <result column="COD_ENTIDAD" jdbcType="NUMERIC" property="codEntidad" />
    <result column="COD_MODALIDAD_CONTRATO" jdbcType="NUMERIC" property="codModalidadContrato" />
    <result column="COD_UTL_UAN" jdbcType="NUMERIC" property="codUtlUan" />
    <result column="COD_CARGO" jdbcType="NUMERIC" property="codCargo" />
    <result column="DETALLES_CONTRATO" jdbcType="VARCHAR" property="detallesContrato" />
    <result column="FLG_APROBADO" jdbcType="NUMERIC" property="flgAprobado" />
    <result column="COD_USUARIO_APRUEBA" jdbcType="NUMERIC" property="codUsuarioAprueba" />
    <result column="FECHA_APROBACION" jdbcType="TIMESTAMP" property="fechaAprobacion" />
    <result column="AUD_FECHA_ACTUALIZACION" jdbcType="TIMESTAMP" property="audFechaActualizacion" />
    <result column="AUD_COD_USUARIO" jdbcType="NUMERIC" property="audCodUsuario" />
    <result column="AUD_COD_ROL" jdbcType="NUMERIC" property="audCodRol" />
    <result column="AUD_ACCION" jdbcType="NUMERIC" property="audAccion" />
    <result column="FLG_ACTIVO" jdbcType="NUMERIC" property="flgActivo" />
    <result column="SALARIO" jdbcType="NUMERIC" property="salario" />
  </resultMap>
  
  <resultMap id="BaseResultMapExt" type="co.gov.dafp.sigep2.bean.ext.HojaVidaExt">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    <result column="COD_HOJA_VIDA" jdbcType="NUMERIC" property="codHojaVida" />
    <result column="COD_PERSONA" jdbcType="NUMERIC" property="codPersona" />
    <result column="COD_ENTIDAD" jdbcType="NUMERIC" property="codEntidad" />
    <result column="COD_MODALIDAD_CONTRATO" jdbcType="NUMERIC" property="codModalidadContrato" />
    <result column="COD_UTL_UAN" jdbcType="NUMERIC" property="codUtlUan" />
    <result column="COD_CARGO" jdbcType="NUMERIC" property="codCargo" />
    <result column="DETALLES_CONTRATO" jdbcType="VARCHAR" property="detallesContrato" />
    <result column="FLG_APROBADO" jdbcType="NUMERIC" property="flgAprobado" />
    <result column="COD_USUARIO_APRUEBA" jdbcType="NUMERIC" property="codUsuarioAprueba" />
    <result column="FECHA_APROBACION" jdbcType="TIMESTAMP" property="fechaAprobacion" />
    <result column="AUD_FECHA_ACTUALIZACION" jdbcType="TIMESTAMP" property="audFechaActualizacion" />
    <result column="AUD_COD_USUARIO" jdbcType="NUMERIC" property="audCodUsuario" />
    <result column="AUD_COD_ROL" jdbcType="NUMERIC" property="audCodRol" />
    <result column="AUD_ACCION" jdbcType="NUMERIC" property="audAccion" />
    <result column="FLG_ACTIVO" jdbcType="NUMERIC" property="flgActivo" />
    <result column="SALARIO" jdbcType="NUMERIC" property="salario" />
    
    <result column="NOMBRE_ENTIDAD" jdbcType="VARCHAR" property="nombreEntidad" />
    <result column="NOMBRE_MODALIDAD" jdbcType="VARCHAR" property="nombreModalidad" />
    <result column="NOMBRE_CARGO" jdbcType="VARCHAR" property="nombreCargo" />
    <result column="NOMBRE_UTL_UAN" jdbcType="VARCHAR" property="nombreUtlUan" />
    <result column="NOMBRE_USUARIO_APRUEBA" jdbcType="VARCHAR" property="nombreUsuarioAprueba" />
    <result column="NOMBRE_PERSONA" jdbcType="VARCHAR" property="nombrePersona" />
    <result column="IMAGEN_HOJA_VIDA_URL" jdbcType="VARCHAR" property="imagenHojaVidaUrl" />
    <result column="DIAS_PERMITIDOS" jdbcType="NUMERIC" property="diasPermitidios" />
    <result column="DIAS_DE_APROBACION" jdbcType="NUMERIC" property="diasDeAprobacion" />
    <result column="TOTAL_CONTRATOS" jdbcType="NUMERIC" property="totalContratos" />
    <result column="TOTAL_PLANTA" jdbcType="NUMERIC" property="totalPlanta" />
    <result column="TOTAL_SIN_VERIFICAR" jdbcType="NUMERIC" property="totalSinVerificar" />
    <result column="NOMBRE_TIPO_DOCUMENTO" jdbcType="VARCHAR" property="nombreTipoDocumento" />
    <result column="NUMERO_IDENTIFICACION" jdbcType="VARCHAR" property="numeroIdentificacion" />
  </resultMap>
  
  <resultMap id="BaseResultMapPortal" type="co.gov.dafp.sigep2.portal.HojaVidaPortal">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    <result column="COD_PERSONA" jdbcType="NUMERIC" property="codPersona" />
    <result column="NOMBRE_FUNCIONARIO" jdbcType="VARCHAR" property="nombreFuncionario" />
    <result column="NOMBRES" jdbcType="VARCHAR" property="nombres" />
    <result column="APELLIDOS" jdbcType="VARCHAR" property="apellidos" />
    <result column="FOTO_URL" jdbcType="VARCHAR" property="fotoUrl" />
    <result column="DENOMINACION_CARGO" jdbcType="VARCHAR" property="denominacionCargo" />
    <result column="NOMBRE_ENTIDAD" jdbcType="VARCHAR" property="nombreEntidad" />
    <result column="CORREO_ELECTRONICO" jdbcType="VARCHAR" property="correoElectronico" />
    <result column="NUM_TELEFONO_OFICINA" jdbcType="VARCHAR" property="numeroTelefonoOfcina" />
    <result column="FAX" jdbcType="VARCHAR" property="numeroFax" />
    <result column="NOMBRE_PAIS" jdbcType="VARCHAR" property="nombrePaisNacimiento" />
    <result column="NOMBRE_DEPARTAMENTO" jdbcType="VARCHAR" property="nombreDepartamentoNacimiento" />
    <result column="NOMBRE_MUNICIPIO" jdbcType="VARCHAR" property="nombreMunicipioNacimiento" />
    <result column="NOMBRE_TIPO_VINCULACION" jdbcType="VARCHAR" property="nombreTipoVinculacion" />
    <result column="NOMBRE_DENOMINACION" jdbcType="VARCHAR" property="denominacionCargo" />
    <result column="NOMBRE_PLANTA" jdbcType="VARCHAR" property="nombrePlanta" />
  </resultMap>
  
  <resultMap id="BaseResultMapFormacion" type="co.gov.dafp.sigep2.portal.FormacionProfesionalPortal">
    <result column="NIVEL_FORMACION" jdbcType="VARCHAR" property="nivelDeFormacion" />
    <result column="AREA_CONOCIMIENTO" jdbcType="VARCHAR" property="areaConocimiento" />
    <result column="ESTADO" jdbcType="VARCHAR" property="estado" />
    <result column="PROGRAMA_ACADEMICO" jdbcType="VARCHAR" property="programaAcademico" />
    <result column="NIVEL_EDUCATIVO" jdbcType="VARCHAR" property="nivelEducativo" />
  </resultMap>
  
  <resultMap id="BaseResultMapExperiencia" type="co.gov.dafp.sigep2.portal.ExperianciaLaboralPortal">
    <result column="CARGO" jdbcType="VARCHAR" property="cargo" />
    <result column="NOMBRE_ENTIDAD" jdbcType="VARCHAR" property="entidad" />
    <result column="FECHA_INGRESO" jdbcType="TIMESTAMP" property="fechaInicio" />
    <result column="FECHA_RETIRO" jdbcType="TIMESTAMP" property="fechaFin" />
    <result column="ESTADO" jdbcType="VARCHAR" property="estado" />
  </resultMap>
  
  <resultMap id="BaseResultMapPersona" type="co.gov.dafp.sigep2.bean.ext.PersonaExt">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Feb 08 14:16:06 COT 2018.
    -->
    <id column="COD_PERSONA" jdbcType="NUMERIC" property="codPersona" />
    <result column="COD_GENERO" jdbcType="NUMERIC" property="codGenero" />
    <result column="COD_ESTADO_CIVIL" jdbcType="NUMERIC" property="codEstadoCivil" />
    <result column="COD_MUNICIPIO_NACIMIENTO" jdbcType="NUMERIC" property="codMunicipioNacimiento" />
    <result column="COD_DEPARTAMENTO_NACIMIENTO" jdbcType="NUMERIC" property="codDepartamentoNacimiento" />
    <result column="COD_PAIS_NACIMIENTO" jdbcType="NUMERIC" property="codPaisNacimiento" />
    <result column="COD_FACTOR_RH" jdbcType="NUMERIC" property="codFactorRh" />
    <result column="COD_TIPO_IDENTIFICACION" jdbcType="NUMERIC" property="codTipoIdentificacion" />
    <result column="NUMERO_IDENTIFICACION" jdbcType="VARCHAR" property="numeroIdentificacion" />
    <result column="PRIMER_NOMBRE" jdbcType="VARCHAR" property="primerNombre" />
    <result column="SEGUNDO_NOMBRE" jdbcType="VARCHAR" property="segundoNombre" />
    <result column="PRIMER_APELLIDO" jdbcType="VARCHAR" property="primerApellido" />
    <result column="SEGUNDO_APELLIDO" jdbcType="VARCHAR" property="segundoApellido" />
    <result column="RESUMEN_PROFESIONAL" jdbcType="VARCHAR" property="resumenProfesional" />
    <result column="NUMERO_LIBRETA_MILITAR" jdbcType="VARCHAR" property="numeroLibretaMilitar" />
    <result column="LIBRETA_MILITAR_URL" jdbcType="VARCHAR" property="libretaMilitarUrl" />
    <result column="DOCUMENTO_IDENTIFICACION_URL" jdbcType="VARCHAR" property="documentoIdentificacionUrl" />
    <result column="DISTRITO_MILITAR" jdbcType="VARCHAR" property="distritoMilitar" />
    <result column="CLASE_LIBRETA_MILITAR" jdbcType="NUMERIC" property="claseLibretaMilitar" />
    <result column="FOTO_URL" jdbcType="VARCHAR" property="fotoUrl" />
    <result column="FECHA_NACIMIENTO" jdbcType="TIMESTAMP" property="fechaNacimiento" />
    <result column="EXPUESTO_POLITICAMENTE" jdbcType="NUMERIC" property="expuestoPoliticamente" />
    <result column="CORREO_ELECTRONICO" jdbcType="VARCHAR" property="correoElectronico" />
    <result column="CORREO_ALTERNATIVO" jdbcType="VARCHAR" property="correoAlternativo" />
    <result column="FLG_ACTIVO" jdbcType="NUMERIC" property="flgActivo" />
    <result column="FLG_ESTADO" jdbcType="NUMERIC" property="flgEstado" />
    <result column="AUD_FECHA_ACTUALIZACION" jdbcType="TIMESTAMP" property="audFechaActualizacion" />
    <result column="AUD_COD_USUARIO" jdbcType="NUMERIC" property="audCodUsuario" />
    <result column="AUD_COD_ROL" jdbcType="NUMERIC" property="audCodRol" />
    <result column="AUD_ACCION" jdbcType="NUMERIC" property="audAccion" />
    <result column="COD_PERTENENCIA_ETNICA" jdbcType="NUMERIC" property="codPertenenciaEtnica" />
    <result column="COD_SIGEP" jdbcType="VARCHAR" property="codSigep" />
    <result column="FLG_DOCUMENTO_IDENTIFICACION_VALIDADO" jdbcType="NUMERIC" property="flgDocumentoIdentificacionValidado" />
    <result column="FLG_LIBRETA_MILITAR_VALIDADA" jdbcType="NUMERIC" property="flgLibretaMilitarValidada" />
    <result column="FECHA_MARCACION_PEP" jdbcType="TIMESTAMP" property="fechaMarcacionPep" />
    <result column="MARCACION_PEP_VIN" jdbcType="NUMERIC" property="marcacionPepVinc" />
    <result column="PORCENTAJE_HV" jdbcType="NUMERIC" property="porcentajeHV" />
    
    <result column="NOMBRE_ENTIDAD" jdbcType="VARCHAR" property="nombreEntidad" />
    <result column="NOMBRE_PAIS" jdbcType="VARCHAR" property="nombrePais" />
    <result column="NOMBRE_DEPARTAMENTO" jdbcType="VARCHAR" property="nombreDepartamento" />
    <result column="NOMBRE_MUNICIPIO" jdbcType="VARCHAR" property="nombreMunicipio" />
    <result column="NOMBRE_ESTADO_CIVIL" jdbcType="VARCHAR" property="nombreEstadoCivil" />
    <result column="NOMBRE_LIBRETA_MILITAR" jdbcType="VARCHAR" property="nombreLibretaMilitar" />
    <result column="NOMBRE_GENERO" jdbcType="VARCHAR" property="nombreGenero" />
    <result column="NOMBRE_TIPO_DOCUMENTO" jdbcType="VARCHAR" property="nombreTipoDocuento" />
    <result column="NOMBRE_MUNICIPIO_RESIDENCIA" jdbcType="VARCHAR" property="nombreMunicipioResidencia" />
    <result column="NOMBRE_DEPARTAMENTO_RESIDENCIA" jdbcType="VARCHAR" property="nombreDepartamentoResidencia" />
    <result column="NOMBRE_PAIS_RESIDENCIA" jdbcType="VARCHAR" property="nombrePaisResidencia" />
    <result column="DIRECCION_RESIDENCIA" jdbcType="VARCHAR" property="direccionResidencia" />
    <result column="NOMBRE_PERTENENCIA_ETNICA" jdbcType="VARCHAR" property="nombrePertenenciaEtnica" />
    <result column="TOTAL" jdbcType="VARCHAR" property="total" />
    <result column="COD_ENTIDAD" jdbcType="NUMERIC" property="codEntidad" />
    <result column="COD_USUARIO" jdbcType="NUMERIC" property="codUsuario" />
    <result column="NOMBRE_USUARIO" jdbcType="VARCHAR" property="nombreUsuario" />
    <result column="NUM_CELULAR" jdbcType="VARCHAR" property="numCelular" />
    <result column="NUM_TELEFONO_OFICINA" jdbcType="VARCHAR" property="numTelefonoOficina" />
    <result column="TELEFONO_RESIDENCIA" jdbcType="VARCHAR" property="telefonoResidencia" />
    <result column="EXTENCION_TELEFONO_OFICINA" jdbcType="VARCHAR" property="extencionTelefonoOficina" />
    <result column="FLG_APROBADO" jdbcType="NUMERIC" property="flgAprobado" />
    <result column="COD_ROL" jdbcType="NUMERIC" property="codRol" />
    <result column="COD_VINCULACION" jdbcType="NUMERIC" property="codVinculacion" />
    <result column="TIPO_ASOCIACION" jdbcType="NUMERIC" property="tipoAsociacion" />
    <result column="NOMBRE_CARGO" jdbcType="VARCHAR" property="nombreCargo" />
    <result column="FECHA_POSESION" jdbcType="TIMESTAMP" property="fechaPosesion" />
    <result column="FECHA_FINALIZACION" jdbcType="TIMESTAMP" property="fechaFinalizacion" />
    <result column="VINCULACION" jdbcType="NUMERIC" property="vinculacion"/>
    <result column="DESHACERVINC" jdbcType="NUMERIC" property="deshacerVinc"/>
    <result column="FECHAVINC" jdbcType="TIMESTAMP" property="fechaVinc"/>
    <result column="DIASDESVINC" jdbcType="NUMERIC" property="diasDesvinc"/>
   	<result column="CAUSAL_DESVINCULACION" jdbcType="NUMERIC" property="causalDesv"/>
   	<result column="PAR_DIAS_DESV" jdbcType="NUMERIC" property="parDiasDesv"/>
    <result column="TOTAL_RESPONSABLE" jdbcType="NUMERIC" property="totalResponsable"/>
    <result column="TOTAL_RESPONSABLE_NACIONAL" jdbcType="NUMERIC" property="totalResponsableNacional"/>
    <result column="TOTAL_RESPONSABLE_TERRRITORIAL" jdbcType="NUMERIC" property="totalResponsableTerritorial"/>
    
    <result column="COD_ENTIDAD_PLANTA" jdbcType="NUMERIC" property="codEntidadPlanta"/>
	<result column="COD_ENTIDAD_PLANTA_DETALLE" jdbcType="NUMERIC" property="codEntidadPlantaDetalle"/>
	<result column="COD_NOMENCLATURA_DENOMINACION" jdbcType="NUMERIC" property="codNomenclaturaDenominacion"/>
	<result column="COD_DENOMINACION" jdbcType="NUMERIC" property="codDenominacion"/>
	<result column="NOMBRE_DENOMINACION" jdbcType="VARCHAR" property="nombreDenominacion"/>
	<result column="NOMBRE_PERSONA_COMPLETO" jdbcType="VARCHAR" property="nombrePersonaCompleto"/>
	<result column="FECHA_APRUEBA" jdbcType="TIMESTAMP" property="fechaAprobacionHV"/>
    
  </resultMap>
  
  <sql id="Example_Where_Clause">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    COD_HOJA_VIDA, COD_PERSONA, COD_ENTIDAD, COD_MODALIDAD_CONTRATO, COD_UTL_UAN, COD_CARGO, 
    DETALLES_CONTRATO, FLG_APROBADO, COD_USUARIO_APRUEBA, FECHA_APROBACION, AUD_FECHA_ACTUALIZACION, 
    AUD_COD_USUARIO, AUD_COD_ROL, AUD_ACCION, FLG_ACTIVO, SALARIO
  </sql>
  <select id="selectByExample" parameterType="co.gov.dafp.sigep2.bean.HojaVidaExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from HOJA_VIDA
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="hojavidaportal" parameterType="co.gov.dafp.sigep2.portal.BusquedaPortal" resultMap="BaseResultMapPortal">
	    	SELECT P.COD_PERSONA, ' ' AS NUMERO_CONTRATO, P.PRIMER_NOMBRE || ' ' || P.SEGUNDO_NOMBRE AS NOMBRES, P.PRIMER_APELLIDO || ' ' || P.SEGUNDO_APELLIDO AS APELLIDOS,
					P.CORREO_ALTERNATIVO AS CORREO_ELECTRONICO, 
					E.TELEFONO_ENTIDAD AS NUM_TELEFONO_OFICINA, E.FAX,
          			P3.VALOR_PARAMETRO||P.FOTO_URL AS FOTO_URL,
					E.NOMBRE_ENTIDAD,
		            D.NOMBRE_DEPARTAMENTO,
					M.NOMBRE_MUNICIPIO,
		            PA.NOMBRE_PAIS,
		            P2.NOMBRE_PARAMETRO AS NOMBRE_TIPO_VINCULACION, 
		            C.NOMBRE_DENOMINACION || ' ' || grado.nombre_parametro AS NOMBRE_DENOMINACION, 
		            clasificacion.nombre_parametro as NOMBRE_PLANTA
           FROM  VINCULACION V
		    INNER JOIN PERSONA P ON V.COD_PERSONA = P.COD_PERSONA
            INNER JOIN ENTIDAD_PLANTA_DETALLE EN ON EN.COD_ENTIDAD_PLANTA_DETALLE = V.COD_ENTIDAD_PLANTA_DETALLE
            INNER JOIN ENTIDAD_PLANTA EP ON EP.COD_ENTIDAD_PLANTA = EN.COD_ENTIDAD_PLANTA
            LEFT JOIN NOMENCLATURA_DENOMINACION ND ON EN.COD_NOMENCLATURA_DENOMINACION = ND.COD_NOMENCLATURA_DENOMINACION
            LEFT JOIN DENOMINACION C ON C.COD_DENOMINACION = ND.COD_DENOMINACION
            LEFT JOIN USUARIO U ON U.COD_PERSONA = P.COD_PERSONA
            LEFT JOIN USUARIO_ENTIDAD UE ON UE.COD_USUARIO = U.COD_USUARIO
            LEFT JOIN ENTIDAD E ON UE.COD_ENTIDAD = E.COD_ENTIDAD
            LEFT JOIN DEPARTAMENTO D on D.COD_DEPARTAMENTO = E.COD_DEPARTAMENTO
            LEFT JOIN MUNICIPIO M on M.COD_MUNICIPIO = E.COD_MUNICIPIO
            LEFT JOIN PAIS PA ON PA.COD_PAIS = E.COD_PAIS
            LEFT JOIN PARAMETRICA P2 on UE.COD_TIPO_VINCULACION = P2.COD_TABLA_PARAMETRICA
            LEFT JOIN PARAMETRICA P3 on 2185 = P3.COD_TABLA_PARAMETRICA
            LEFT JOIN PARAMETRICA grado on grado.cod_tabla_parametrica = nd.cod_grado
            LEFT JOIN parametrica clasificacion on clasificacion.cod_tabla_parametrica = ep.cod_clasificacion_planta
		WHERE P.COD_PERSONA   =  #{codPersona,jdbcType=NUMERIC}
		  AND E.COD_ENTIDAD   =  #{codEntidad,jdbcType=NUMERIC}
		  AND V.FLG_ACTIVO    = 1
          AND E.COD_ESTADO_ENTIDAD = 1480
          UNION
          SELECT DISTINCT P.COD_PERSONA, C2.NUMERO_CONTRATO,
          P.PRIMER_NOMBRE || ' ' || P.SEGUNDO_NOMBRE AS NOMBRES, 
          P.PRIMER_APELLIDO || ' ' || P.SEGUNDO_APELLIDO AS APELLIDOS,
					P.CORREO_ALTERNATIVO AS CORREO_ELECTRONICO, E2.TELEFONO_ENTIDAD AS NUM_TELEFONO_OFICINA, E2.FAX,  
					P3.VALOR_PARAMETRO||P.FOTO_URL AS FOTO_URL,
					E2.NOMBRE_ENTIDAD,
		      D.NOMBRE_DEPARTAMENTO,
					M.NOMBRE_MUNICIPIO,
		      PA.NOMBRE_PAIS,
		      P2.NOMBRE_PARAMETRO AS NOMBRE_TIPO_VINCULACION, 'CONTRATISTA' AS NOMBRE_DENOMINACION , '' AS  NOMBRE_PLANTA
          FROM  PERSONA P
						INNER JOIN USUARIO U on P.COD_PERSONA = U.COD_PERSONA
            INNER JOIN USUARIO_ENTIDAD E on U.COD_USUARIO = E.COD_USUARIO
						LEFT JOIN PARAMETRICA P2 on E.COD_TIPO_VINCULACION = P2.COD_TABLA_PARAMETRICA
            INNER JOIN  ENTIDAD E2 on E.COD_ENTIDAD = E2.COD_ENTIDAD
            LEFT JOIN PAIS PA ON PA.COD_PAIS = E2.COD_PAIS
            LEFT JOIN DEPARTAMENTO D on D.COD_DEPARTAMENTO = E2.COD_DEPARTAMENTO
		  	    LEFT JOIN MUNICIPIO M on M.COD_MUNICIPIO = E2.COD_MUNICIPIO
            INNER JOIN CONTRATO C2 on P.COD_PERSONA = C2.COD_PERSONA
            INNER JOIN CONTRATO C3 on E2.COD_ENTIDAD = C3.COD_ENTIDAD
            LEFT JOIN PARAMETRICA P3 on 2185 = P3.COD_TABLA_PARAMETRICA
		WHERE P.COD_PERSONA   =  #{codPersona,jdbcType=NUMERIC}
		 AND E.COD_ENTIDAD   =  #{codEntidad,jdbcType=NUMERIC}
         AND E2.COD_ESTADO_ENTIDAD = 1480
         AND U.FLG_ESTADO = 1
         AND C2.FLG_ACTIVO = 1
         AND C3.FLG_ACTIVO = 1
         OFFSET 0 ROWS FETCH NEXT 1 ROWS ONLY
  </select>
  <select id="formacionPortal" parameterType="co.gov.dafp.sigep2.portal.BusquedaPortal" resultMap="BaseResultMapFormacion">
	   SELECT P1.NOMBRE_PARAMETRO AS NIVEL_FORMACION, P2.NOMBRE_PARAMETRO AS AREA_CONOCIMIENTO,
	   		  P3.NOMBRE_PARAMETRO AS NIVEL_EDUCATIVO,
	   	 CASE WHEN E.FLG_FINALIZADO =1 THEN 'Graduado' END
			 || CASE WHEN E.FLG_FINALIZADO = 0 THEN 'NO GRADUADO' END
       		 || CASE WHEN E.FLG_FINALIZADO = null THEN 'NO GRADUADO' END as ESTADO,
       		 CASE WHEN PA.nombre_programa_academico IS NOT NULL THEN PA.nombre_programa_academico END
    			|| CASE WHEN PA.nombre_programa_academico IS null THEN 'NO APLICA' END AS PROGRAMA_ACADEMICO
		FROM EDUCACION_FORMAL E
			LEFT JOIN PARAMETRICA P1 ON P1.COD_TABLA_PARAMETRICA = E.COD_NIVEL_FORMACION
			LEFT JOIN PARAMETRICA P2 ON P2.COD_TABLA_PARAMETRICA = E.COD_AREA_CONOCIMIENTO
			LEFT JOIN PARAMETRICA P3 ON P3.COD_TABLA_PARAMETRICA =e.cod_nivel_educativo
			LEFT JOIN PROGRAMA_ACADEMICO PA ON   pa.cod_titulo_academico = e.cod_titulo_obtenido
		WHERE COD_PERSONA = #{codPersona,jdbcType=NUMERIC}
		AND E.FLG_ACTIVO = 1
  </select>
  <select id="experianciaLaboralPortal" parameterType="co.gov.dafp.sigep2.portal.BusquedaPortal" resultMap="BaseResultMapExperiencia">
	    SELECT ex.NOMBRE_ENTIDAD,  cargo.nombre_cargo CARGO, ex.FECHA_INGRESO, ex.FECHA_RETIRO, CASE WHEN ex.FLG_ACTIVO_ENTIDAD = 1 THEN 'Actualmente' END
			 || CASE WHEN ex.FLG_ACTIVO_ENTIDAD = 0 THEN 'Retirado' END
       		 || CASE WHEN ex.FLG_ACTIVO_ENTIDAD = null THEN 'Retirado' END as ESTADO
	  	FROM EXPERIENCIA_PROFESIONAL ex
	  	LEFT JOIN CARGO_HOJA_VIDA cargo on cargo.cod_cargo_hoja_vida = ex.cod_cargo_hv
		WHERE ex.FLG_ACTIVO = 1
		AND ex.COD_ENTIDAD IS NULL
		AND ex.COD_PERSONA = #{codPersona,jdbcType=NUMERIC}
	  UNION
	  SELECT case when E.NOMBRE_INSTITUCION is not null then E.NOMBRE_INSTITUCION else ex.nombre_institucion end, 'DOCENTE' AS CARGO, EX.FECHA_INGRESO, FECHA_FINALIZACION as FECHA_RETIRO,
		CASE WHEN EX.FLG_ACTUALMENTE = 1 THEN 'Actualmente' END
					 || CASE WHEN EX.FLG_ACTUALMENTE = 0 THEN 'Retirado' END
		       		 || CASE WHEN EX.FLG_ACTUALMENTE = null THEN 'Retirado' END as ESTADO
		FROM EXPERIENCIA_DOCENTE EX
             LEFT JOIN INSTITUCION_EDUCATIVA E on EX.COD_INSTITUCION = E.COD_INSTITUCION_EDUCATIVA
             WHERE EX.FLG_ACTIVO = 1
             AND EX.COD_PERSONA = #{codPersona,jdbcType=NUMERIC}
        UNION
        SELECT ENTIDAD.NOMBRE_ENTIDAD,  cargo.nombre_cargo CARGO, ex.FECHA_INGRESO, ex.FECHA_RETIRO, CASE WHEN ex.FLG_ACTIVO_ENTIDAD = 1 THEN 'Actualmente' END
			 || CASE WHEN ex.FLG_ACTIVO_ENTIDAD = 0 THEN 'Retirado' END
       		 || CASE WHEN ex.FLG_ACTIVO_ENTIDAD = null THEN 'Retirado' END as ESTADO
	  FROM EXPERIENCIA_PROFESIONAL ex
         INNER JOIN ENTIDAD ON ENTIDAD.COD_ENTIDAD = ex.COD_ENTIDAD
         LEFT JOIN CARGO_HOJA_VIDA cargo on cargo.cod_cargo_hoja_vida = ex.cod_cargo_hv
         WHERE ex.FLG_ACTIVO = 1
		AND ex.COD_PERSONA = #{codPersona,jdbcType=NUMERIC}
		order by FECHA_RETIRO desc
  </select>
  <select id="selectHojaFiltro" parameterType="co.gov.dafp.sigep2.bean.HojaVida" resultMap="BaseResultMapExt">
    select 
    hv.*,
    (SELECT NOMBRE_ENTIDAD FROM ENTIDAD WHERE COD_ENTIDAD = hv.COD_ENTIDAD) NOMBRE_ENTIDAD,
    (SELECT NOMBRE_PARAMETRO FROM PARAMETRICA WHERE COD_TABLA_PARAMETRICA = hv.COD_MODALIDAD_CONTRATO) NOMBRE_MODALIDAD,
    (SELECT NOMBRE_CARGO FROM CARGO WHERE COD_CARGO = hv.COD_CARGO) NOMBRE_CARGO,
    (SELECT CONCAT(CONCAT(CONCAT(CONCAT(P.PRIMER_NOMBRE, ' '), P.SEGUNDO_NOMBRE),' '),CONCAT(CONCAT(P.PRIMER_APELLIDO, ' '), P.SEGUNDO_APELLIDO))
        FROM PERSONA P 
        INNER JOIN USUARIO U ON U.COD_PERSONA = P.COD_PERSONA 
        WHERE U.COD_USUARIO = hv.COD_USUARIO_APRUEBA) NOMBRE_USUARIO_APRUEBA,
    (SELECT CONCAT(CONCAT(CONCAT(CONCAT(P.PRIMER_NOMBRE, ' '), P.SEGUNDO_NOMBRE),' '),CONCAT(CONCAT(P.PRIMER_APELLIDO, ' '), P.SEGUNDO_APELLIDO))
        FROM PERSONA P
       WHERE P.COD_PERSONA = hv.COD_PERSONA) NOMBRE_PERSONA
from HOJA_VIDA hv
    WHERE COD_HOJA_VIDA > 0 
      <if test="codPersona != null">
        AND hv.COD_PERSONA = #{codPersona,jdbcType=NUMERIC}
      </if>
      <if test="codEntidad != null">
        AND hv.COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
      </if>
      <if test="codModalidadContrato != null">
        AND hv.COD_MODALIDAD_CONTRATO = #{codModalidadContrato,jdbcType=NUMERIC}
      </if>
      <if test="codUtlUan != null">
        AND hv.COD_UTL_UAN = #{codUtlUan,jdbcType=NUMERIC}
      </if>
      <if test="codCargo != null">
        AND hv.COD_CARGO = #{codCargo,jdbcType=NUMERIC}
      </if>
      <if test="detallesContrato != null">
        AND UPPER(hv.DETALLES_CONTRATO) LIKE '%'||UPPER(#{detallesContrato,jdbcType=VARCHAR})||'%'
      </if>
      <if test="flgAprobado != null">
        AND hv.FLG_APROBADO = #{flgAprobado,jdbcType=NUMERIC}
      </if>
      <if test="codUsuarioAprueba != null">
        AND hv.COD_USUARIO_APRUEBA = #{codUsuarioAprueba,jdbcType=NUMERIC}
      </if>
      <if test="fechaAprobacion != null">
        AND hv.FECHA_APROBACION = #{fechaAprobacion,jdbcType=TIMESTAMP}
      </if>
      <if test="audFechaActualizacion != null">
        AND hv.AUD_FECHA_ACTUALIZACION = #{audFechaActualizacion,jdbcType=TIMESTAMP}
      </if>
      <if test="flgActivo != null">
        AND hv.FLG_ACTIVO = #{flgActivo,jdbcType=NUMERIC}
      </if>
     OFFSET #{limitInit,jdbcType=NUMERIC} ROWS FETCH NEXT #{limitEnd,jdbcType=NUMERIC} ROWS ONLY
  </select>
  <insert id="eliminarHojaVida" parameterType="co.gov.dafp.sigep2.bean.ext.HojaVidaExt"  statementType = "CALLABLE" >
			{CALL sp_eliminar_hoja_vida(#{codPersona,jdbcType=NUMERIC},
			                            #{audCodUsuario,jdbcType=NUMERIC},
			                            #{codEntidad,jdbcType=NUMERIC},
			                            #{justificacionEliminacion,jdbcType=VARCHAR},
			                            #{codHojaVida,jdbcType=NUMERIC})}
  </insert>
  <delete id="deleteByExample" parameterType="co.gov.dafp.sigep2.bean.HojaVidaExample">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    delete from HOJA_VIDA
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="co.gov.dafp.sigep2.bean.HojaVida">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    insert into HOJA_VIDA (COD_PERSONA, COD_ENTIDAD, 
      COD_MODALIDAD_CONTRATO, COD_UTL_UAN, COD_CARGO, 
      DETALLES_CONTRATO, FLG_APROBADO, COD_USUARIO_APRUEBA, 
      FECHA_APROBACION, AUD_FECHA_ACTUALIZACION, 
      AUD_COD_USUARIO, AUD_COD_ROL, AUD_ACCION, 
      FLG_ACTIVO, SALARIO)
    values (#{codPersona,jdbcType=NUMERIC}, #{codEntidad,jdbcType=NUMERIC}, 
      #{codModalidadContrato,jdbcType=NUMERIC}, #{codUtlUan,jdbcType=NUMERIC}, #{codCargo,jdbcType=NUMERIC}, 
      #{detallesContrato,jdbcType=VARCHAR}, #{flgAprobado,jdbcType=NUMERIC}, #{codUsuarioAprueba,jdbcType=NUMERIC}, 
      #{fechaAprobacion,jdbcType=TIMESTAMP}, #{audFechaActualizacion,jdbcType=TIMESTAMP}, 
      #{audCodUsuario,jdbcType=NUMERIC}, #{audCodRol,jdbcType=NUMERIC}, #{audAccion,jdbcType=NUMERIC}, 
      #{flgActivo,jdbcType=NUMERIC}, #{salario,jdbcType=NUMERIC})
  </insert>
  <insert id="insertSelective" parameterType="co.gov.dafp.sigep2.bean.HojaVida">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    insert into HOJA_VIDA
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="codHojaVida != null">
        COD_HOJA_VIDA,
      </if>
      <if test="codPersona != null">
        COD_PERSONA,
      </if>
      <if test="codEntidad != null">
        COD_ENTIDAD,
      </if>
      <if test="codModalidadContrato != null">
        COD_MODALIDAD_CONTRATO,
      </if>
      <if test="codUtlUan != null">
        COD_UTL_UAN,
      </if>
      <if test="codCargo != null">
        COD_CARGO,
      </if>
      <if test="detallesContrato != null">
        DETALLES_CONTRATO,
      </if>
      <if test="flgAprobado != null">
        FLG_APROBADO,
      </if>
      <if test="codUsuarioAprueba != null">
        COD_USUARIO_APRUEBA,
      </if>
      <if test="fechaAprobacion != null">
        FECHA_APROBACION,
      </if>
      <if test="audFechaActualizacion != null">
        AUD_FECHA_ACTUALIZACION,
      </if>
      <if test="audCodUsuario != null">
        AUD_COD_USUARIO,
      </if>
      <if test="audCodRol != null">
        AUD_COD_ROL,
      </if>
      <if test="audAccion != null">
        AUD_ACCION,
      </if>
      <if test="flgActivo != null">
        FLG_ACTIVO,
      </if>
      <if test="salario != null">
        SALARIO,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="codHojaVida != null">
        #{codHojaVida,jdbcType=NUMERIC},
      </if>
      <if test="codPersona != null">
        #{codPersona,jdbcType=NUMERIC},
      </if>
      <if test="codEntidad != null">
        #{codEntidad,jdbcType=NUMERIC},
      </if>
      <if test="codModalidadContrato != null">
        #{codModalidadContrato,jdbcType=NUMERIC},
      </if>
      <if test="codUtlUan != null">
        #{codUtlUan,jdbcType=NUMERIC},
      </if>
      <if test="codCargo != null">
        #{codCargo,jdbcType=NUMERIC},
      </if>
      <if test="detallesContrato != null">
        #{detallesContrato,jdbcType=VARCHAR},
      </if>
      <if test="flgAprobado != null">
        #{flgAprobado,jdbcType=NUMERIC},
      </if>
      <if test="codUsuarioAprueba != null">
        #{codUsuarioAprueba,jdbcType=NUMERIC},
      </if>
      <if test="fechaAprobacion != null">
        #{fechaAprobacion,jdbcType=TIMESTAMP},
      </if>
      <if test="audFechaActualizacion != null">
        #{audFechaActualizacion,jdbcType=TIMESTAMP},
      </if>
      <if test="audCodUsuario != null">
        #{audCodUsuario,jdbcType=NUMERIC},
      </if>
      <if test="audCodRol != null">
        #{audCodRol,jdbcType=NUMERIC},
      </if>
      <if test="audAccion != null">
        #{audAccion,jdbcType=NUMERIC},
      </if>
      <if test="flgActivo != null">
        #{flgActivo,jdbcType=NUMERIC},
      </if>
      <if test="salario != null">
        #{salario,jdbcType=NUMERIC},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="co.gov.dafp.sigep2.bean.HojaVidaExample" resultType="java.lang.Long">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    select count(*) from HOJA_VIDA
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    update HOJA_VIDA
    <set>
      <if test="record.codHojaVida != null">
        COD_HOJA_VIDA = #{record.codHojaVida,jdbcType=NUMERIC},
      </if>
      <if test="record.codPersona != null">
        COD_PERSONA = #{record.codPersona,jdbcType=NUMERIC},
      </if>
      <if test="record.codEntidad != null">
        COD_ENTIDAD = #{record.codEntidad,jdbcType=NUMERIC},
      </if>
      <if test="record.codModalidadContrato != null">
        COD_MODALIDAD_CONTRATO = #{record.codModalidadContrato,jdbcType=NUMERIC},
      </if>
      <if test="record.codUtlUan != null">
        COD_UTL_UAN = #{record.codUtlUan,jdbcType=NUMERIC},
      </if>
      <if test="record.codCargo != null">
        COD_CARGO = #{record.codCargo,jdbcType=NUMERIC},
      </if>
      <if test="record.detallesContrato != null">
        DETALLES_CONTRATO = #{record.detallesContrato,jdbcType=VARCHAR},
      </if>
      <if test="record.flgAprobado != null">
        FLG_APROBADO = #{record.flgAprobado,jdbcType=NUMERIC},
      </if>
      <if test="record.codUsuarioAprueba != null">
        COD_USUARIO_APRUEBA = #{record.codUsuarioAprueba,jdbcType=NUMERIC},
      </if>
      <if test="record.fechaAprobacion != null">
        FECHA_APROBACION = #{record.fechaAprobacion,jdbcType=TIMESTAMP},
      </if>
      <if test="record.audFechaActualizacion != null">
        AUD_FECHA_ACTUALIZACION = #{record.audFechaActualizacion,jdbcType=TIMESTAMP},
      </if>
      <if test="record.audCodUsuario != null">
        AUD_COD_USUARIO = #{record.audCodUsuario,jdbcType=NUMERIC},
      </if>
      <if test="record.audCodRol != null">
        AUD_COD_ROL = #{record.audCodRol,jdbcType=NUMERIC},
      </if>
      <if test="record.audAccion != null">
        AUD_ACCION = #{record.audAccion,jdbcType=NUMERIC},
      </if>
      <if test="record.flgActivo != null">
        FLG_ACTIVO = #{record.flgActivo,jdbcType=NUMERIC},
      </if>
      <if test="record.salario != null">
        SALARIO = #{record.salario,jdbcType=NUMERIC},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:00:26 COT 2018.
    -->
    update HOJA_VIDA
    set COD_HOJA_VIDA = #{record.codHojaVida,jdbcType=NUMERIC},
      COD_PERSONA = #{record.codPersona,jdbcType=NUMERIC},
      COD_ENTIDAD = #{record.codEntidad,jdbcType=NUMERIC},
      COD_MODALIDAD_CONTRATO = #{record.codModalidadContrato,jdbcType=NUMERIC},
      COD_UTL_UAN = #{record.codUtlUan,jdbcType=NUMERIC},
      COD_CARGO = #{record.codCargo,jdbcType=NUMERIC},
      DETALLES_CONTRATO = #{record.detallesContrato,jdbcType=VARCHAR},
      FLG_APROBADO = #{record.flgAprobado,jdbcType=NUMERIC},
      COD_USUARIO_APRUEBA = #{record.codUsuarioAprueba,jdbcType=NUMERIC},
      FECHA_APROBACION = #{record.fechaAprobacion,jdbcType=TIMESTAMP},
      AUD_FECHA_ACTUALIZACION = #{record.audFechaActualizacion,jdbcType=TIMESTAMP},
      AUD_COD_USUARIO = #{record.audCodUsuario,jdbcType=NUMERIC},
      AUD_COD_ROL = #{record.audCodRol,jdbcType=NUMERIC},
      AUD_ACCION = #{record.audAccion,jdbcType=NUMERIC},
      FLG_ACTIVO = #{record.flgActivo,jdbcType=NUMERIC},
      SALARIO = #{record.salario,jdbcType=NUMERIC}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="co.gov.dafp.sigep2.bean.HojaVida">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:23:12 COT 2018.
    -->
    update HOJA_VIDA
    <set>
      <if test="codPersona != null">
        COD_PERSONA = #{codPersona,jdbcType=NUMERIC},
      </if>
      <if test="codEntidad != null">
        COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC},
      </if>
      <if test="codModalidadContrato != null">
        COD_MODALIDAD_CONTRATO = #{codModalidadContrato,jdbcType=NUMERIC},
      </if>
      <if test="codUtlUan != null">
        COD_UTL_UAN = #{codUtlUan,jdbcType=NUMERIC},
      </if>
      <if test="codCargo != null">
        COD_CARGO = #{codCargo,jdbcType=NUMERIC},
      </if>
      <if test="detallesContrato != null">
        DETALLES_CONTRATO = #{detallesContrato,jdbcType=VARCHAR},
      </if>
      <if test="flgAprobado != null">
        FLG_APROBADO = #{flgAprobado,jdbcType=NUMERIC},
      </if>
      <if test="codUsuarioAprueba != null">
        COD_USUARIO_APRUEBA = #{codUsuarioAprueba,jdbcType=NUMERIC},
      </if>
      <if test="fechaAprobacion != null">
        FECHA_APROBACION = #{fechaAprobacion,jdbcType=TIMESTAMP},
      </if>
      <if test="audFechaActualizacion != null">
        AUD_FECHA_ACTUALIZACION = #{audFechaActualizacion,jdbcType=TIMESTAMP},
      </if>
      <if test="audCodUsuario != null">
        AUD_COD_USUARIO = #{audCodUsuario,jdbcType=NUMERIC},
      </if>
      <if test="audCodRol != null">
        AUD_COD_ROL = #{audCodRol,jdbcType=NUMERIC},
      </if>
      <if test="audAccion != null">
        AUD_ACCION = #{audAccion,jdbcType=NUMERIC},
      </if>
      <if test="flgActivo != null">
        FLG_ACTIVO = #{flgActivo,jdbcType=NUMERIC},
      </if>
      <if test="salario != null">
        SALARIO = #{salario,jdbcType=NUMERIC},
      </if>
    </set>
    where COD_HOJA_VIDA = #{codHojaVida,jdbcType=NUMERIC}
  </update>
  <update id="updateByPrimaryKey" parameterType="co.gov.dafp.sigep2.bean.HojaVida">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 02 08:23:12 COT 2018.
    -->
    update HOJA_VIDA
    set COD_PERSONA = #{codPersona,jdbcType=NUMERIC},
      COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC},
      COD_MODALIDAD_CONTRATO = #{codModalidadContrato,jdbcType=NUMERIC},
      COD_UTL_UAN = #{codUtlUan,jdbcType=NUMERIC},
      COD_CARGO = #{codCargo,jdbcType=NUMERIC},
      DETALLES_CONTRATO = #{detallesContrato,jdbcType=VARCHAR},
      FLG_APROBADO = #{flgAprobado,jdbcType=NUMERIC},
      COD_USUARIO_APRUEBA = #{codUsuarioAprueba,jdbcType=NUMERIC},
      FECHA_APROBACION = #{fechaAprobacion,jdbcType=TIMESTAMP},
      AUD_FECHA_ACTUALIZACION = #{audFechaActualizacion,jdbcType=TIMESTAMP},
      AUD_COD_USUARIO = #{audCodUsuario,jdbcType=NUMERIC},
      AUD_COD_ROL = #{audCodRol,jdbcType=NUMERIC},
      AUD_ACCION = #{audAccion,jdbcType=NUMERIC},
      FLG_ACTIVO = #{flgActivo,jdbcType=NUMERIC},
      SALARIO = #{salario,jdbcType=NUMERIC}
    where COD_HOJA_VIDA = #{codHojaVida,jdbcType=NUMERIC}
  </update>
  <select id="selectPersonaHojaVidaAprobada" parameterType="co.gov.dafp.sigep2.bean.HojaVida" resultMap="BaseResultMapExt">
	SELECT 
	    DISTINCT hv.*
	FROM HOJA_VIDA hv
	WHERE 
	    hv.COD_PERSONA = #{codPersona,jdbcType=NUMERIC}
	    AND hv.COD_ENTIDAD= #{codEntidad,jdbcType=NUMERIC}
	    AND hv.FLG_ACTIVO= 1
	    AND hv.FLG_APROBADO=1
	    AND EXTRACT(MONTH FROM AGE(NOW(), hv.FECHA_APROBACION)) &lt;= #{tiempoAprobacion,jdbcType=NUMERIC}
     OFFSET #{limitInit,jdbcType=NUMERIC} ROWS FETCH NEXT #{limitEnd,jdbcType=NUMERIC} ROWS ONLY
  </select>
  
   <select id="validarUsuarioHV" parameterType="co.gov.dafp.sigep2.bean.ext.VinculacionExt" resultMap="BaseResultMapExt">
      SELECT hv.COD_PERSONA, HV.FECHA_APROBACION, HV.FLG_APROBADO, trunc(to_date(sysdate,'DD/MM/YYYY'))-trunc(to_date(HV.FECHA_APROBACION,'DD/MM/YYYY')) as DIAS_DE_APROBACION,
       (SELECT VALOR_PARAMETRO FROM PARAMETRICA WHERE COD_TABLA_PARAMETRICA = 1959) as DIAS_PERMITIDOS,
       (SELECT COUNT(C.FLG_ACTIVO) FROM CONTRATO C WHERE C.COD_PERSONA = P.COD_PERSONA AND C.FLG_ACTIVO = 1) TOTAL_CONTRATOS,
       (SELECT COUNT(*) FROM ENTIDAD_PLANTA WHERE COD_ENTIDAD = 1 AND FLG_ACTIVO = 1) AS TOTAL_PLANTA
     FROM HOJA_VIDA HV
		INNER JOIN PERSONA P on HV.COD_PERSONA = P.COD_PERSONA
		WHERE P.NUMERO_IDENTIFICACION =  #{numeroIdentificacion,jdbcType=VARCHAR}
		AND P.COD_TIPO_IDENTIFICACION =  #{codTipoIentificacion,jdbcType=NUMERIC}
    OFFSET 0 ROWS FETCH NEXT 1 ROWS ONLY
   </select>
   <select id="getTotalAprobados" parameterType="co.gov.dafp.sigep2.bean.ext.HojaVidaExt" resultMap="BaseResultMapExt">
		  SELECT SUM (TOTAL) TOTAL_SIN_VERIFICAR 
		FROM(
    		SELECT COUNT (*) TOTAL
        		FROM EDUCACION_FORMAL ef
            	WHERE ef.COD_PERSONA = #{codPersona,jdbcType=NUMERIC}
            		AND ef.FLG_ACTIVO = #{flgActivo,jdbcType=NUMERIC}
            		AND ef.FLG_VALIDADO_TARJETA_PROFESIONAL = #{flgAprobado,jdbcType=NUMERIC}
                    AND ef.URL_TARJETA_PROFESIONAL IS NOT NULL
		UNION ALL   
    		select COUNT (*)TOTAL
        		from experiencia_profesional ep 
        		where ep.COD_PERSONA = #{codPersona,jdbcType=NUMERIC}
            		and ep.FLG_ACTIVO = #{flgActivo,jdbcType=NUMERIC}
            		and ep.FLG_VALIDA_JEFE = #{flgAprobado,jdbcType=NUMERIC}
                    and ep.URL_DOCUMENTO_SOPORTE IS NOT NULL
		UNION ALL
    		select COUNT(*)TOTAL
        		from experiencia_docente ed
        		where ed.cod_persona = #{codPersona,jdbcType=NUMERIC}
        			and ed.flg_Activo = #{flgActivo,jdbcType=NUMERIC}
       				and ed.flg_verificado = #{flgAprobado,jdbcType=NUMERIC}
                    and ed.URL_DOCUMENTO_SOPORTE IS NOT NULL
                    
		)
  </select>
   <select id="selectHVPersonaConUTL" parameterType="co.gov.dafp.sigep2.bean.ext.HojaVidaExt" resultMap="BaseResultMapExt">
		select hv.*, ep.nombre_planta ||': ' || p.PRIMER_NOMBRE ||' '|| p.SEGUNDO_NOMBRE ||' '|| p.PRIMER_APELLIDO ||' '|| p.SEGUNDO_APELLIDO as NOMBRE_UTL_UAN, e.nombre_entidad
		 from hoja_vida hv
            inner join planta_persona_UTL_UAN ppu on ppu.cod_planta_persona_utl_uan = hv.cod_utl_uan 
    		inner join entidad_planta ep on ep.cod_entidad_planta = ppu.cod_entidad_planta
    		inner join entidad e on e.cod_entidad = hv.cod_entidad
    		inner join persona p on p.cod_persona = ppu.cod_persona
   		 where 1 = 1
   		 <if test="codPersona != null">
   		  	and hv.cod_persona = #{codPersona,jdbcType=NUMERIC}
   		 </if>
   		 <if test="flgActivo != null">
   		 	and ep.flg_activo = #{flgActivo,jdbcType=NUMERIC}
   		 </if>
   		 <if test="codUtlUan != null">
   		 and hv.COD_UTL_UAN = #{codUtlUan,jdbcType=NUMERIC}
   		 </if>
   		 <if test="codEntidad != null">
   		 and hv.COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
   		 </if>
  </select>
  
  <select id="selectHVPorCodPersona" parameterType="co.gov.dafp.sigep2.bean.ext.VinculacionExt" resultMap="BaseResultMapExt">
		 SELECT hv.COD_PERSONA, HV.FECHA_APROBACION, HV.FLG_APROBADO, HV.COD_UTL_UAN, trunc(to_date(sysdate,'DD/MM/YYYY'))-trunc(to_date(HV.FECHA_APROBACION,'DD/MM/YYYY')) as DIAS_DE_APROBACION,
        (SELECT VALOR_PARAMETRO FROM PARAMETRICA WHERE COD_TABLA_PARAMETRICA = 1959) as DIAS_PERMITIDOS
     FROM HOJA_VIDA HV
		INNER JOIN PERSONA P on HV.COD_PERSONA = P.COD_PERSONA
        WHERE P.NUMERO_IDENTIFICACION =  #{numeroIdentificacion,jdbcType=VARCHAR}
		AND P.COD_TIPO_IDENTIFICACION =  #{codTipoIentificacion,jdbcType=NUMERIC}
		AND HV.COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
        AND HV.FLG_ACTIVO = 1
  </select>
  <select id="selectPersonaRoles" parameterType="co.gov.dafp.sigep2.bean.HojaVida" resultMap="BaseResultMapExt">
		select ue.* from usuario_rol_entidad ure
         inner join usuario_entidad ue on ue.cod_usuario_entidad = ure.cod_usuario_entidad
         inner join usuario u on ue.cod_usuario = u.cod_usuario
         inner join persona p on u.cod_persona = p.cod_persona
        where p.cod_persona = #{codPersona,jdbcType=NUMERIC}
        and ue.cod_entidad = #{codEntidad,jdbcType=NUMERIC}
  </select>
  
     <select id="selectHVPersonaAsociadaUTL" parameterType="co.gov.dafp.sigep2.bean.ext.HojaVidaExt" resultMap="BaseResultMapExt">
		select hv.*,
			p.PRIMER_NOMBRE ||' '|| p.SEGUNDO_NOMBRE ||' '|| p.PRIMER_APELLIDO ||' '|| p.SEGUNDO_APELLIDO NOMBRE_PERSONA,
			pa.nombre_parametro NOMBRE_TIPO_DOCUMENTO,
			p.numero_identificacion
			from hoja_vida hv
			inner join persona p on p.cod_persona = hv.cod_persona
			inner join parametrica pa on pa.cod_tabla_parametrica = p.cod_tipo_identificacion
			where 1=1
   		 <if test="codPersona != null">
   		  	and hv.cod_persona = #{codPersona,jdbcType=NUMERIC}
   		 </if>
   		 <if test="flgActivo != null">
   		 	and hv.flg_activo = #{flgActivo,jdbcType=NUMERIC}
   		 </if>
   		 <if test="codUtlUan != null">
   		 	and hv.COD_UTL_UAN = #{codUtlUan,jdbcType=NUMERIC}
   		 </if>
   		 <if test="codEntidad != null">
   		 	and hv.COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
   		 </if>
  	</select>
  	
  	<select id="getHojaVidaPersona" parameterType="co.gov.dafp.sigep2.bean.ext.PersonaExt" resultMap="BaseResultMapPersona">
		SELECT
		pe.primer_nombre||' '||pe.segundo_nombre||' '||pe.primer_apellido||' '||pe.segundo_apellido NOMBRE_PERSONA_COMPLETO,
		PE.COD_PERSONA,
		PE.COD_TIPO_IDENTIFICACION,
		PE.NUMERO_IDENTIFICACION, 
		PE.PRIMER_NOMBRE, 
		PE.SEGUNDO_NOMBRE,
		PE.PRIMER_APELLIDO, 
		PE.SEGUNDO_APELLIDO,
		hv.cod_entidad,
		hv.FECHA_APROBACION FECHA_APRUEBA
		FROM PERSONA PE 
		INNER JOIN HOJA_VIDA HV ON PE.COD_PERSONA = HV.COD_PERSONA 
		WHERE 1=1
		and hv.COD_HOJA_VIDA = #{codHojaVida,jdbcType=NUMERIC} 
  	</select>
</mapper>