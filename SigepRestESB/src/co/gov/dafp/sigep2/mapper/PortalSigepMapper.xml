<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.gov.dafp.sigep2.interfaces.PortalSigepMapper">
  <resultMap id="BaseResultMap" type="co.gov.dafp.sigep2.bean.PortalSigep">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Nov 06 16:36:22 COT 2019.
    -->
    <result column="COD_PERSONA" jdbcType="NUMERIC" property="codPersona" />
    <result column="NOMBRES" jdbcType="VARCHAR" property="nombres" />
    <result column="APELLIDOS" jdbcType="VARCHAR" property="apellidos" />
    <result column="CORREO_ELECTRONICO" jdbcType="VARCHAR" property="correoElectronico" />
    <result column="NUM_TELEFONO_OFICINA" jdbcType="VARCHAR" property="numTelefonoOficina" />
    <result column="FOTO_URL" jdbcType="VARCHAR" property="fotoUrl" />
    <result column="COD_ENTIDAD" jdbcType="NUMERIC" property="codEntidad" />
    <result column="NOMBRE_ENTIDAD" jdbcType="VARCHAR" property="nombreEntidad" />
    <result column="COD_DEPARTAMENTO" jdbcType="NUMERIC" property="codDepartamento" />
    <result column="NOMBRE_DEPARTAMENTO" jdbcType="VARCHAR" property="nombreDepartamento" />
    <result column="COD_MUNICIPIO" jdbcType="NUMERIC" property="codMunicipio" />
    <result column="NOMBRE_MUNICIPIO" jdbcType="VARCHAR" property="nombreMunicipio" />
    <result column="COD_TABLA_PARAMETRICA" jdbcType="NUMERIC" property="codTablaParametrica" />
    <result column="TIPO_CONTRATO" jdbcType="VARCHAR" property="tipoContrato" />
    <result column="CARGO" jdbcType="VARCHAR" property="cargo" />
    <result column="COD_DENOMINACION" jdbcType="NUMERIC" property="codDenominacion" />
    <result column="COD_NIVEL_JERARQUICO" jdbcType="NUMERIC" property="codNivelJerarquico" />
    <result column="NOMBRE_NIVEL_JERARQUICO" jdbcType="VARCHAR" property="nombreNivelJerarquico" />
    <result column="GENERO" jdbcType="VARCHAR" property="genero" />
    <result column="EXPUESTO_POLITICAMENTE" jdbcType="NUMERIC" property="expuestoPoliticamente" />
    <result column="NUMERO_CONTRATO" jdbcType="VARCHAR" property="numeroContrato" />
    <result column="NOMBRE_PLANTA" jdbcType="VARCHAR" property="nombrePlanta" />
    <result column="PRIMER_NOMBRE" jdbcType="VARCHAR" property="primerNombre" />
    <result column="SEGUNDO_NOMBRE" jdbcType="VARCHAR" property="segundoNombre" />
    <result column="PRIMER_APELLIDO" jdbcType="VARCHAR" property="primerApellido" />
    <result column="SEGUNDO_APELLIDO" jdbcType="VARCHAR" property="segundoApellido" />
    <result column="COD_CARGO_REFERENCIA" jdbcType="NUMERIC" property="codCargoReferencia" />
    <result column="NOMBRE_CARGO_REFERENCIA" jdbcType="VARCHAR" property="nombreCargoReferencia" />
  </resultMap>
  
  <resultMap id="BaseResultMapResultados" type="co.gov.dafp.sigep2.portal.Resultados">
    <result column="TOTAL_REGISTROS" jdbcType="NUMERIC" property="totalRegistros" />
    <result column="COD_PERSONA" jdbcType="NUMERIC" property="codPersona" />
    <result column="COD_DEPARTAMENTO" jdbcType="NUMERIC" property="codDepartamento" />
    <result column="COD_MUNICIPIO" jdbcType="NUMERIC" property="codMunicipio" />
    <result column="COD_TABLA_PARAMETRICA" jdbcType="NUMERIC" property="codTipoContrato" />
    <result column="COD_DENOMINACION" jdbcType="NUMERIC" property="codDenominacion" />
    <result column="COD_NIVEL_JERARQUICO" jdbcType="NUMERIC" property="codNivelJerarquico" />
    <result column="FOTO_URL" jdbcType="VARCHAR" property="fotoUrl" />
    <result column="NOMBRE_FUNCIONARIO" jdbcType="VARCHAR" property="nombreFuncionario" />
    <result column="NOMBRES" jdbcType="VARCHAR" property="nombres" />
    <result column="APELLIDOS" jdbcType="VARCHAR" property="apellidos" />
    <result column="CORREO_ELECTRONICO" jdbcType="VARCHAR" property="emailFuncionario" />
    <result column="NUM_TELEFONO_OFICINA" jdbcType="VARCHAR" property="telefonoFuncionario" />
    <result column="COD_ENTIDAD" jdbcType="NUMERIC" property="codEntidad" />
    <result column="EXPUESTO_POLITICAMENTE" jdbcType="NUMERIC" property="expuestoPoliticamente" />
    <result column="NOMBRE_ENTIDAD" jdbcType="VARCHAR" property="nombreEntidad" />
    <result column="NOMBRE_DEPARTAMENTO" jdbcType="VARCHAR" property="nombreDepartamento" />
    <result column="NOMBRE_MUNICIPIO" jdbcType="VARCHAR" property="nombreMunicipio" />
    <result column="TIPO_CONTRATO" jdbcType="VARCHAR" property="nombreTipoContrato" />
    <result column="GENERO" jdbcType="VARCHAR" property="genero" />
    <result column="NOMBRE_DENOMINACION" jdbcType="VARCHAR" property="nombreDenominacion" />
    <result column="CARGO" jdbcType="VARCHAR" property="cargo" />
    <result column="NOMBRE_PLANTA" jdbcType="VARCHAR" property="nombrePlanta" />
    <result column="NUMERO_CONTRATO" jdbcType="VARCHAR" property="numeroContrato" />
    <result column="NOMBRE_NIVEL_JERARQUICO" jdbcType="VARCHAR" property="nombreNivelJerarquico" />
    <result column="COD_CARGO_REFERENCIA" jdbcType="NUMERIC" property="codCargoReferencia" />
    <result column="NOMBRE_CARGO_REFERENCIA" jdbcType="VARCHAR" property="nombreCargoReferencia" />
  </resultMap>
  
  <resultMap id="BaseResultMapDeptoFiltro" type="co.gov.dafp.sigep2.portal.DepartamentoFiltro">
    <result column="TOTAL_REGISTROS" jdbcType="NUMERIC" property="totalRegistros" />
    <result column="COD_DEPARTAMENTO" jdbcType="NUMERIC" property="codDepartamento" />
    <result column="NOMBRE_DEPARTAMENTO" jdbcType="VARCHAR" property="nombre" />
  </resultMap>
  
  <resultMap id="BaseResultMapMunFiltro" type="co.gov.dafp.sigep2.portal.MunicipioFiltro">
    <result column="TOTAL_REGISTROS" jdbcType="NUMERIC" property="totalRegistros" />
     <result column="COD_MUNICIPIO" jdbcType="NUMERIC" property="codMunicipio" />
    <result column="NOMBRE_MUNICIPIO" jdbcType="VARCHAR" property="nombre" />
  </resultMap>
  
  <resultMap id="BaseResultMapEntFiltro" type="co.gov.dafp.sigep2.portal.InstitucionFiltro">
    <result column="TOTAL_REGISTROS" jdbcType="NUMERIC" property="totalRegistros" />
    <result column="COD_ENTIDAD" jdbcType="NUMERIC" property="codEntidad" />
    <result column="NOMBRE_ENTIDAD" jdbcType="VARCHAR" property="nombre" />
  </resultMap>
  
  <resultMap id="BaseResultMapTipoConFiltro" type="co.gov.dafp.sigep2.portal.TipoContratoFiltro">
    <result column="TOTAL_REGISTROS" jdbcType="NUMERIC" property="totalRegistros" />
    <result column="COD_TABLA_PARAMETRICA" jdbcType="NUMERIC" property="codTipoContrato" />
    <result column="TIPO_CONTRATO" jdbcType="VARCHAR" property="nombre" />
  </resultMap>
  
  <resultMap id="BaseResultMapExpuestoFiltro" type="co.gov.dafp.sigep2.portal.ExpuestoPoliticamenteFiltro">
    <result column="TOTAL_REGISTROS" jdbcType="NUMERIC" property="totalRegistros" />
    <result column="EXPUESTO_POLITICAMENTE" jdbcType="NUMERIC" property="expuestoPoliticamente" />
    <result column="DESCRIPCION_EXPUESTO" jdbcType="VARCHAR" property="descripcionExpuesto" />
  </resultMap>
  
  <resultMap id="BaseResultMapNivelJerarquicoFiltro" type="co.gov.dafp.sigep2.portal.NivelJerarquicoFiltro">
    <result column="TOTAL_REGISTROS" jdbcType="NUMERIC" property="totalRegistros" />
    <result column="COD_NIVEL_JERARQUICO" jdbcType="NUMERIC" property="codNivelJerarquico" />
    <result column="NOMBRE_NIVEL_JERARQUICO" jdbcType="VARCHAR" property="nombreNivelJerarquico" />
  </resultMap>
  
  
  <resultMap id="BaseResultMapCargoReferenciaFiltro" type="co.gov.dafp.sigep2.portal.CargoReferenciaFiltro">
    <result column="TOTAL_REGISTROS" jdbcType="NUMERIC" property="totalRegistros" />
    <result column="COD_CARGO_REFERENCIA" jdbcType="NUMERIC" property="codCargoReferencia" />
    <result column="NOMBRE_CARGO_REFERENCIA" jdbcType="VARCHAR" property="nombreCargoReferencia" />
  </resultMap>
  
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Nov 06 16:36:22 COT 2019.
    -->
    COD_PERSONA, NOMBRES, APELLIDOS, CORREO_ELECTRONICO, NUM_TELEFONO_OFICINA, FOTO_URL, 
    COD_ENTIDAD, NOMBRE_ENTIDAD, COD_DEPARTAMENTO, NOMBRE_DEPARTAMENTO, COD_MUNICIPIO, 
    NOMBRE_MUNICIPIO, COD_TABLA_PARAMETRICA, TIPO_CONTRATO, CARGO, COD_DENOMINACION, 
    COD_NIVEL_JERARQUICO, NOMBRE_NIVEL_JERARQUICO, GENERO, EXPUESTO_POLITICAMENTE, NUMERO_CONTRATO, 
    NOMBRE_PLANTA, PRIMER_NOMBRE, SEGUNDO_NOMBRE, PRIMER_APELLIDO, SEGUNDO_APELLIDO
  </sql>
  
  
  
  <select id="busquedaServidor" parameterType="co.gov.dafp.sigep2.portal.BusquedaPortal" resultMap="BaseResultMapResultados">
		 SELECT DISTINCT p.*, count(*) over() TOTAL_REGISTROS 
		FROM PORTAL_SIGEP p
		where
		TRIM(UPPER(translate(p.primer_nombre||p.segundo_nombre||
		p.primer_apellido||p.segundo_apellido||p.nombre_entidad||
		p.nombre_departamento||p.nombre_municipio||p.tipo_contrato||p.cargo, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU')))
		like '%'||UPPER(REPLACE(translate(#{criterio1,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'),' ', '%'))||'%'

    <if test="codTipoContrato != null">
  		AND COD_TABLA_PARAMETRICA = #{codTipoContrato,jdbcType=NUMERIC}
  	</if>
   <if test="codEntidad != null">
     AND COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
   </if>
   <if test="codDepartamento != null">
       AND COD_DEPARTAMENTO =  #{codDepartamento,jdbcType=NUMERIC}
   </if>
   <if test="codMunicipio != null">
      AND COD_MUNICIPIO =  #{codMunicipio,jdbcType=NUMERIC}
   </if>
    <if test="codPais != null">
     AND COD_PAIS = #{codPais,jdbcType=NUMERIC}
   </if>
    <if test="expuestoPoliticamente != null">
     AND COALESCE(EXPUESTO_POLITICAMENTE,0) = #{expuestoPoliticamente,jdbcType=NUMERIC}
   </if>
   <if test="codDenominacion != null">
     AND COD_DENOMINACION = #{codDenominacion,jdbcType=NUMERIC}
   </if>
   <if test="codNivelJerarquico != null">
     AND COD_NIVEL_JERARQUICO = #{codNivelJerarquico,jdbcType=NUMERIC}
   </if>
   <if test="codCargoReferencia != null">
     AND  COD_CARGO_REFERENCIA = #{codCargoReferencia,jdbcType=NUMERIC}
   </if>
    <if test="nombreDenominacion != null">
     AND UPPER(NOMBRE_DENOMINACION) LIKE '%' || UPPER(#{nombreDenominacion,jdbcType=VARCHAR}) || '%'
   </if>  
   OFFSET #{limiteInicial,jdbcType=NUMERIC} ROWS FETCH NEXT #{limiteFinal,jdbcType=NUMERIC} ROWS ONLY
  </select>
  
  <select id="busquedaServidorT" parameterType="co.gov.dafp.sigep2.portal.BusquedaPortal" resultMap="BaseResultMapResultados">
	   SELECT count(*) over() TOTAL_REGISTROS from (
		   select distinct cod_persona 
		   FROM PORTAL_SIGEP
		   JOIN (SELECT column_value filter 
		          FROM table(sys.odcivarchar2list(	TRIM(UPPER(translate(#{criterio1,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'))),
		          									TRIM(UPPER(translate(#{criterio2,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'))),
		          									TRIM(UPPER(translate(#{criterio3,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'))),
		          									TRIM(UPPER(translate(#{criterio4,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'))),
		          									TRIM(UPPER(translate(#{criterio5,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU')))
		          									))
		    ) ON TRIM(UPPER(translate(PORTAL_SIGEP.PRIMER_NOMBRE, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU')))LIKE FILTER
		      OR TRIM(UPPER(translate(PORTAL_SIGEP.SEGUNDO_NOMBRE, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'))) LIKE FILTER
		      OR TRIM(UPPER(translate(PORTAL_SIGEP.PRIMER_APELLIDO, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'))) LIKE FILTER
		      OR TRIM(UPPER(translate(PORTAL_SIGEP.SEGUNDO_APELLIDO, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'))) LIKE FILTER
		      OR TRIM(UPPER(translate(PORTAL_SIGEP.NOMBRE_ENTIDAD, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'))) LIKE FILTER
		      OR TRIM(UPPER(translate(PORTAL_SIGEP.NOMBRE_DEPARTAMENTO, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'))) LIKE FILTER
		      OR TRIM(UPPER(translate(PORTAL_SIGEP.NOMBRE_MUNICIPIO, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'))) LIKE FILTER
		      OR TRIM(UPPER(translate(PORTAL_SIGEP.TIPO_CONTRATO, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'))) LIKE FILTER
		      OR TRIM(UPPER(translate(PORTAL_SIGEP.CARGO, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'))) LIKE FILTER
		    WHERE 1 =1
		    <if test="codTipoContrato != null">
		  		AND COD_TABLA_PARAMETRICA = #{codTipoContrato,jdbcType=NUMERIC}
		  	</if>
		   <if test="codEntidad != null">
		     AND COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
		   </if>
		   <if test="codDepartamento != null">
		       AND COD_DEPARTAMENTO =  #{codDepartamento,jdbcType=NUMERIC}
		   </if>
		   <if test="codMunicipio != null">
		      AND COD_MUNICIPIO =  #{codMunicipio,jdbcType=NUMERIC}
		   </if>
		    <if test="codPais != null">
		     AND COD_PAIS = #{codPais,jdbcType=NUMERIC}
		   </if>
		    <if test="expuestoPoliticamente != null">
		     AND COALESCE(EXPUESTO_POLITICAMENTE,0) = #{expuestoPoliticamente,jdbcType=NUMERIC}
		   </if>
		   <if test="codDenominacion != null">
		     AND COD_DENOMINACION = #{codDenominacion,jdbcType=NUMERIC}
		   </if>
		    <if test="nombreDenominacion != null">
		     AND UPPER(NOMBRE_DENOMINACION) LIKE '%' || UPPER(#{nombreDenominacion,jdbcType=VARCHAR}) || '%'
		   </if> 
		   <if test="codNivelJerarquico != null">
		     AND COD_NIVEL_JERARQUICO = #{codNivelJerarquico,jdbcType=NUMERIC}
		   </if>
		   <if test="codCargoReferencia != null">
		     AND  COD_CARGO_REFERENCIA = #{codCargoReferencia,jdbcType=NUMERIC}
		   </if>
		   )
		   OFFSET 1 ROWS FETCH NEXT 1 ROWS ONLY
  </select>
  
  <select id="busquedaServidorDepFiltro" parameterType="co.gov.dafp.sigep2.portal.BusquedaPortal" resultMap="BaseResultMapDeptoFiltro">
  	SELECT A.COD_DEPARTAMENTO , A.NOMBRE_DEPARTAMENTO, COUNT(COD_DEPARTAMENTO) TOTAL_REGISTROS  
	FROM(
		  SELECT DISTINCT COD_DEPARTAMENTO, NOMBRE_DEPARTAMENTO , COD_PERSONA
				FROM PORTAL_SIGEP p
				where
				TRIM(UPPER(translate(p.primer_nombre||p.segundo_nombre||
				p.primer_apellido||p.segundo_apellido||p.nombre_entidad||
				p.nombre_departamento||p.nombre_municipio||p.tipo_contrato||p.cargo, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU')))
				like '%'||UPPER(REPLACE(translate(#{criterio1,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'),' ', '%'))||'%'
		  
  
    <if test="codTipoContrato != null">
  		AND COD_TABLA_PARAMETRICA = #{codTipoContrato,jdbcType=NUMERIC}
  	</if>
   <if test="codEntidad != null">
     AND COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
   </if>
   <if test="codDepartamento != null">
       AND COD_DEPARTAMENTO =  #{codDepartamento,jdbcType=NUMERIC}
   </if>
   <if test="codMunicipio != null">
      AND COD_MUNICIPIO =  #{codMunicipio,jdbcType=NUMERIC}
   </if>
    <if test="codPais != null">
     AND COD_PAIS = #{codPais,jdbcType=NUMERIC}
   </if>
    <if test="expuestoPoliticamente != null">
     AND COALESCE(EXPUESTO_POLITICAMENTE,0) = #{expuestoPoliticamente,jdbcType=NUMERIC}
   </if>
   <if test="codDenominacion != null">
     AND COD_DENOMINACION = #{codDenominacion,jdbcType=NUMERIC}
   </if>
    <if test="nombreDenominacion != null">
     AND UPPER(NOMBRE_DENOMINACION) LIKE '%' || UPPER(#{nombreDenominacion,jdbcType=VARCHAR}) || '%'
   </if> 
   <if test="codNivelJerarquico != null">
     AND COD_NIVEL_JERARQUICO = #{codNivelJerarquico,jdbcType=NUMERIC}
   </if>
   <if test="codCargoReferencia != null">
     AND  COD_CARGO_REFERENCIA = #{codCargoReferencia,jdbcType=NUMERIC}
   </if> 
    ) A
	GROUP BY COD_DEPARTAMENTO , NOMBRE_DEPARTAMENTO
	ORDER BY TOTAL_REGISTROS DESC
  </select>
  
  
  <select id="busquedaServidorMunFiltro" parameterType="co.gov.dafp.sigep2.portal.BusquedaPortal" resultMap="BaseResultMapMunFiltro">	
	SELECT a.COD_MUNICIPIO, a.NOMBRE_MUNICIPIO , COUNT(COD_MUNICIPIO) TOTAL_REGISTROS  
    from (
	     SELECT DISTINCT COD_MUNICIPIO, NOMBRE_MUNICIPIO , COD_PERSONA
				FROM PORTAL_SIGEP p
				where
				TRIM(UPPER(translate(p.primer_nombre||p.segundo_nombre||
				p.primer_apellido||p.segundo_apellido||p.nombre_entidad||
				p.nombre_departamento||p.nombre_municipio||p.tipo_contrato||p.cargo, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU')))
				like '%'||UPPER(REPLACE(translate(#{criterio1,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'),' ', '%'))||'%'
	    <if test="codTipoContrato != null">
	  		AND COD_TABLA_PARAMETRICA = #{codTipoContrato,jdbcType=NUMERIC}
	  	</if>
	   <if test="codEntidad != null">
	     AND COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
	   </if>
	   <if test="codDepartamento != null">
	       AND COD_DEPARTAMENTO =  #{codDepartamento,jdbcType=NUMERIC}
	   </if>
	   <if test="codMunicipio != null">
	      AND COD_MUNICIPIO =  #{codMunicipio,jdbcType=NUMERIC}
	   </if>
	    <if test="codPais != null">
	     AND COD_PAIS = #{codPais,jdbcType=NUMERIC}
	   </if>
	    <if test="expuestoPoliticamente != null">
	     AND COALESCE(EXPUESTO_POLITICAMENTE,0) = #{expuestoPoliticamente,jdbcType=NUMERIC}
	   </if>
	   <if test="codDenominacion != null">
	     AND COD_DENOMINACION = #{codDenominacion,jdbcType=NUMERIC}
	   </if>
	    <if test="nombreDenominacion != null">
	     AND UPPER(NOMBRE_DENOMINACION) LIKE '%' || UPPER(#{nombreDenominacion,jdbcType=VARCHAR}) || '%'
	   </if> 
	   <if test="codNivelJerarquico != null">
	     AND COD_NIVEL_JERARQUICO = #{codNivelJerarquico,jdbcType=NUMERIC}
	   </if>
	   <if test="codCargoReferencia != null">
	     AND  COD_CARGO_REFERENCIA = #{codCargoReferencia,jdbcType=NUMERIC}
	   </if> 
	   )A
	  GROUP BY COD_MUNICIPIO , NOMBRE_MUNICIPIO
	 ORDER BY TOTAL_REGISTROS DESC
  </select>
  
  <select id="busquedaServidorEntFiltro" parameterType="co.gov.dafp.sigep2.portal.BusquedaPortal" resultMap="BaseResultMapEntFiltro">
	  SELECT a.COD_ENTIDAD , a.NOMBRE_ENTIDAD, COUNT(COD_ENTIDAD) TOTAL_REGISTROS from(
	    SELECT DISTINCT COD_ENTIDAD, NOMBRE_ENTIDAD , COD_PERSONA
				FROM PORTAL_SIGEP p
				where
				TRIM(UPPER(translate(p.primer_nombre||p.segundo_nombre||
				p.primer_apellido||p.segundo_apellido||p.nombre_entidad||
				p.nombre_departamento||p.nombre_municipio||p.tipo_contrato||p.cargo, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU')))
				like '%'||UPPER(REPLACE(translate(#{criterio1,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'),' ', '%'))||'%'
	      <if test="codTipoContrato != null">
		  		AND COD_TABLA_PARAMETRICA = #{codTipoContrato,jdbcType=NUMERIC}
		  	</if>
		   <if test="codEntidad != null">
		     AND COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
		   </if>
		   <if test="codDepartamento != null">
		       AND COD_DEPARTAMENTO =  #{codDepartamento,jdbcType=NUMERIC}
		   </if>
		   <if test="codMunicipio != null">
		      AND COD_MUNICIPIO =  #{codMunicipio,jdbcType=NUMERIC}
		   </if>
		    <if test="codPais != null">
		     AND COD_PAIS = #{codPais,jdbcType=NUMERIC}
		   </if>
		    <if test="expuestoPoliticamente != null">
		     AND COALESCE(EXPUESTO_POLITICAMENTE,0) = #{expuestoPoliticamente,jdbcType=NUMERIC}
		   </if>
		   <if test="codDenominacion != null">
		     AND COD_DENOMINACION = #{codDenominacion,jdbcType=NUMERIC}
		   </if>
		    <if test="nombreDenominacion != null">
		     AND UPPER(NOMBRE_DENOMINACION) LIKE '%' || UPPER(#{nombreDenominacion,jdbcType=VARCHAR}) || '%'
		   </if>
		   <if test="codNivelJerarquico != null">
		     AND COD_NIVEL_JERARQUICO = #{codNivelJerarquico,jdbcType=NUMERIC}
		   </if>
		   <if test="codCargoReferencia != null">
		     AND  COD_CARGO_REFERENCIA = #{codCargoReferencia,jdbcType=NUMERIC}
		   </if>  
		   	)a
	   GROUP BY COD_ENTIDAD , NOMBRE_ENTIDAD
	   ORDER BY TOTAL_REGISTROS DESC
  </select>
  <select id="busquedaServidorTipoConFiltro" parameterType="co.gov.dafp.sigep2.portal.BusquedaPortal" resultMap="BaseResultMapTipoConFiltro">
  	SELECT a.COD_TABLA_PARAMETRICA , a.TIPO_CONTRATO, COUNT(COD_TABLA_PARAMETRICA) TOTAL_REGISTROS from( 
  	SELECT DISTINCT COD_TABLA_PARAMETRICA, TIPO_CONTRATO , COD_PERSONA
				FROM PORTAL_SIGEP p
				where
				TRIM(UPPER(translate(p.primer_nombre||p.segundo_nombre||
				p.primer_apellido||p.segundo_apellido||p.nombre_entidad||
				p.nombre_departamento||p.nombre_municipio||p.tipo_contrato||p.cargo, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU')))
				like '%'||UPPER(REPLACE(translate(#{criterio1,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'),' ', '%'))||'%'
    <if test="codTipoContrato != null">
  		AND COD_TABLA_PARAMETRICA = #{codTipoContrato,jdbcType=NUMERIC}
  	</if>
   <if test="codEntidad != null">
     AND COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
   </if>
   <if test="codDepartamento != null">
       AND COD_DEPARTAMENTO =  #{codDepartamento,jdbcType=NUMERIC}
   </if>
   <if test="codMunicipio != null">
      AND COD_MUNICIPIO =  #{codMunicipio,jdbcType=NUMERIC}
   </if>
    <if test="codPais != null">
     AND COD_PAIS = #{codPais,jdbcType=NUMERIC}
   </if>
    <if test="expuestoPoliticamente != null">
     AND COALESCE(EXPUESTO_POLITICAMENTE,0) = #{expuestoPoliticamente,jdbcType=NUMERIC}
   </if>
   <if test="codDenominacion != null">
     AND COD_DENOMINACION = #{codDenominacion,jdbcType=NUMERIC}
   </if>
    <if test="nombreDenominacion != null">
     AND UPPER(NOMBRE_DENOMINACION) LIKE '%' || UPPER(#{nombreDenominacion,jdbcType=VARCHAR}) || '%'
   </if>
   <if test="codNivelJerarquico != null">
     AND COD_NIVEL_JERARQUICO = #{codNivelJerarquico,jdbcType=NUMERIC}
   </if>
   <if test="codCargoReferencia != null">
     AND  COD_CARGO_REFERENCIA = #{codCargoReferencia,jdbcType=NUMERIC}
   </if>  
   )a
  GROUP BY COD_TABLA_PARAMETRICA , TIPO_CONTRATO
  ORDER BY TOTAL_REGISTROS DESC
  </select>
  
  <select id="busquedaServidorExpuestoFiltro" parameterType="co.gov.dafp.sigep2.portal.BusquedaPortal" resultMap="BaseResultMapExpuestoFiltro">
  	SELECT A.descripcion_expuesto, A.expuesto_politicamente, count(expuesto_politicamente) TOTAL_REGISTROS 
  	FROM (
  	 SELECT DISTINCT NVL(expuesto_politicamente,0) expuesto_politicamente, 
        CASE WHEN NVL(expuesto_politicamente,0) = 0 then 'NO' ELSE 'SI' END descripcion_expuesto,
        COD_PERSONA
				FROM PORTAL_SIGEP p
				where
				TRIM(UPPER(translate(p.primer_nombre||p.segundo_nombre||
				p.primer_apellido||p.segundo_apellido||p.nombre_entidad||
				p.nombre_departamento||p.nombre_municipio||p.tipo_contrato||p.cargo, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU')))
				like '%'||UPPER(REPLACE(translate(#{criterio1,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'),' ', '%'))||'%'
  	
		 <if test="codTipoContrato != null">
			AND COD_TABLA_PARAMETRICA = #{codTipoContrato,jdbcType=NUMERIC}
		</if>
		<if test="codEntidad != null">
		  AND COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
		</if>
		<if test="codDepartamento != null">
		    AND COD_DEPARTAMENTO =  #{codDepartamento,jdbcType=NUMERIC}
		</if>
		<if test="codMunicipio != null">
		   AND COD_MUNICIPIO =  #{codMunicipio,jdbcType=NUMERIC}
		</if>
		 <if test="codPais != null">
		  AND COD_PAIS = #{codPais,jdbcType=NUMERIC}
		</if>
		 <if test="expuestoPoliticamente != null">
		  AND COALESCE(EXPUESTO_POLITICAMENTE,0) = #{expuestoPoliticamente,jdbcType=NUMERIC}
		</if>
		<if test="codDenominacion != null">
		  AND COD_DENOMINACION = #{codDenominacion,jdbcType=NUMERIC}
		</if>
		 <if test="nombreDenominacion != null">
		  AND UPPER(NOMBRE_DENOMINACION) LIKE '%' || UPPER(#{nombreDenominacion,jdbcType=VARCHAR}) || '%'
		</if>
		<if test="codNivelJerarquico != null">
	     AND COD_NIVEL_JERARQUICO = #{codNivelJerarquico,jdbcType=NUMERIC}
	   </if>
	   <if test="codCargoReferencia != null">
	     AND  COD_CARGO_REFERENCIA = #{codCargoReferencia,jdbcType=NUMERIC}
	   </if>  
        ) A
		GROUP BY A.descripcion_expuesto, A.expuesto_politicamente
	   	ORDER BY TOTAL_REGISTROS DESC
  </select> 
  
  <select id="busquedaServidorNivelJerarquicoFiltro" parameterType="co.gov.dafp.sigep2.portal.BusquedaPortal" resultMap="BaseResultMapNivelJerarquicoFiltro">
  	SELECT  a.cod_nivel_jerarquico, a.nombre_nivel_jerarquico , COUNT(cod_nivel_jerarquico) TOTAL_REGISTROS  
  	FROM (
  			SELECT DISTINCT cod_nivel_jerarquico, nombre_nivel_jerarquico , COD_PERSONA
				FROM PORTAL_SIGEP p
				where
				TRIM(UPPER(translate(p.primer_nombre||p.segundo_nombre||
				p.primer_apellido||p.segundo_apellido||p.nombre_entidad||
				p.nombre_departamento||p.nombre_municipio||p.tipo_contrato||p.cargo, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU')))
				like '%'||UPPER(REPLACE(translate(#{criterio1,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'),' ', '%'))||'%'
				
  		 <if test="codTipoContrato != null">
			AND COD_TABLA_PARAMETRICA = #{codTipoContrato,jdbcType=NUMERIC}
		</if>
		<if test="codEntidad != null">
		  AND COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
		</if>
		<if test="codDepartamento != null">
		    AND COD_DEPARTAMENTO =  #{codDepartamento,jdbcType=NUMERIC}
		</if>
		<if test="codMunicipio != null">
		   AND COD_MUNICIPIO =  #{codMunicipio,jdbcType=NUMERIC}
		</if>
		 <if test="codPais != null">
		  AND COD_PAIS = #{codPais,jdbcType=NUMERIC}
		</if>
		 <if test="expuestoPoliticamente != null">
		  AND COALESCE(EXPUESTO_POLITICAMENTE,0) = #{expuestoPoliticamente,jdbcType=NUMERIC}
		</if>
		<if test="codDenominacion != null">
		  AND COD_DENOMINACION = #{codDenominacion,jdbcType=NUMERIC}
		</if>
		 <if test="nombreDenominacion != null">
		  AND UPPER(NOMBRE_DENOMINACION) LIKE '%' || UPPER(#{nombreDenominacion,jdbcType=VARCHAR}) || '%'
		</if>
		<if test="codNivelJerarquico != null">
	     AND COD_NIVEL_JERARQUICO = #{codNivelJerarquico,jdbcType=NUMERIC}
	   </if>
	   <if test="codCargoReferencia != null">
	     AND  COD_CARGO_REFERENCIA = #{codCargoReferencia,jdbcType=NUMERIC}
	   </if>  
        ) A
		GROUP BY a.cod_nivel_jerarquico, a.nombre_nivel_jerarquico
	   	ORDER BY TOTAL_REGISTROS DESC
  </select>
  
  <select id="busquedaServidorCargoReferenciaFiltro" parameterType="co.gov.dafp.sigep2.portal.BusquedaPortal" resultMap="BaseResultMapCargoReferenciaFiltro">
  	SELECT  a.cod_cargo_referencia, a.nombre_cargo_referencia, COUNT(cod_cargo_referencia) TOTAL_REGISTROS    
  	FROM (
  	SELECT DISTINCT cod_cargo_referencia, nombre_cargo_referencia , COD_PERSONA
				FROM PORTAL_SIGEP p
				where
				TRIM(UPPER(translate(p.primer_nombre||p.segundo_nombre||
				p.primer_apellido||p.segundo_apellido||p.nombre_entidad||
				p.nombre_departamento||p.nombre_municipio||p.tipo_contrato||p.cargo, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU')))
				like '%'||UPPER(REPLACE(translate(#{criterio1,jdbcType=VARCHAR}, 'áéíóúÁÉÍÓÚ', 'aeiouAEIOU'),' ', '%'))||'%'
		 <if test="codTipoContrato != null">
			AND COD_TABLA_PARAMETRICA = #{codTipoContrato,jdbcType=NUMERIC}
		</if>
		<if test="codEntidad != null">
		  AND COD_ENTIDAD = #{codEntidad,jdbcType=NUMERIC}
		</if>
		<if test="codDepartamento != null">
		    AND COD_DEPARTAMENTO =  #{codDepartamento,jdbcType=NUMERIC}
		</if>
		<if test="codMunicipio != null">
		   AND COD_MUNICIPIO =  #{codMunicipio,jdbcType=NUMERIC}
		</if>
		 <if test="codPais != null">
		  AND COD_PAIS = #{codPais,jdbcType=NUMERIC}
		</if>
		 <if test="expuestoPoliticamente != null">
		  AND COALESCE(EXPUESTO_POLITICAMENTE,0) = #{expuestoPoliticamente,jdbcType=NUMERIC}
		</if>
		<if test="codDenominacion != null">
		  AND COD_DENOMINACION = #{codDenominacion,jdbcType=NUMERIC}
		</if>
		 <if test="nombreDenominacion != null">
		  AND UPPER(NOMBRE_DENOMINACION) LIKE '%' || UPPER(#{nombreDenominacion,jdbcType=VARCHAR}) || '%'
		</if>
		<if test="codNivelJerarquico != null">
	     AND COD_NIVEL_JERARQUICO = #{codNivelJerarquico,jdbcType=NUMERIC}
	   </if>
	   <if test="codCargoReferencia != null">
	     AND  COD_CARGO_REFERENCIA = #{codCargoReferencia,jdbcType=NUMERIC}
	   </if>  
        ) A
		GROUP BY a.cod_cargo_referencia, a.nombre_cargo_referencia
	   	ORDER BY TOTAL_REGISTROS DESC
  </select> 
</mapper>