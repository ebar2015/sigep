<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	template="/resources/template/pageTemplate.xhtml">

	<f:metadata>
		<f:viewParam name="id" value='#{plantillaBean.id}' />
		<f:viewParam name="dialog" value='#{plantillaBean.dialog}' />
		<f:event type="preRenderView" listener='#{plantillaBean.retrieve}' />
		<f:event type="preRenderView" listener='#{plantillaBean.showDialog}' />
	</f:metadata>

	<ui:param name="pageTitle"
		value="${titles['TTL_TRANSVERSAL_PLANTILLA_XML']}" />
	<ui:param name="pageSubtitle"
		value="${titles['TTL_SUB_TRANSVERSAL_PLANTILLA_EDITAR']}" />

	<f:event listener="#{plantillaBean.validateForm}" type="postValidate" />
	<ui:define name="main">
		<p:importConstants
			type="co.gov.dafp.sigep2.util.xml.elemento.TipoCargue"
			var="PFTipoCargue" />
		<p:panelGrid columns="3"
			columnClasses="ui-grid-col-3,ui-grid-col-6,ui-grid-col-3"
			layout="grid" styleClass="ui-panelgrid-blank">
			<p:outputLabel for="nombreProceso"
				value="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_NOMBRE_PROCESO']}" />
			<p:selectOneMenu id="nombreProceso" filter="true"
				filterMatchMode="contains" required="true"
				value="#{plantillaBean.procesoArchivo}"
				converter="plantillaConverter" var="t"
				requiredMessage="${messages['DLG_VALOR_REQUERIDO']}">
				<f:selectItem itemLabel="${titles['TTL_SELECT']}"
					itemValue="#{null}" />
				<f:selectItems var="plantilla" value="#{plantillas}"
					itemDisabled="#{plantilla.nombrePlantilla eq null}"
					itemLabel="#{plantilla.descripcion}" itemValue="#{plantilla}" />
				<p:column>
					<h:outputText
						value="#{t.descripcion.concat(' (').concat(t.nombrePlantilla).concat(')')}" />
				</p:column>
				<p:ajax listener="#{plantillaBean.cargarProcesoEditar}"
					event="change" process="@this" update="@this contains" />
				<p:clientValidator />
			</p:selectOneMenu>
			<p:message for="nombreProceso" display="icon" />
			<p:outputLabel for="versionEsquema"
				value="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_VERSION_ESQUEMA']}" />
			<p:inputText id="versionEsquema"
				placeholder="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_VERSION_ESQUEMA']}"
				title="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_VERSION_ESQUEMA']}"
				value="#{plantillaBean.xml.versionEsquema}" required="true"
				requiredMessage="${messages['DLG_VALOR_REQUERIDO']}">
				<p:clientValidator />
			</p:inputText>
			<p:message for="versionEsquema" display="icon" />
			<p:outputLabel for="tipoEjecucion"
				value="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_TIPO_CARGUE']}" />
			<p:selectOneMenu id="tipoEjecucion" filter="true"
				filterMatchMode="contains" value="#{plantillaBean.xml.tipoCargue}"
				var="t" required="true"
				requiredMessage="${messages['DLG_VALOR_REQUERIDO']}">
				<f:selectItem itemLabel="${titles['TTL_SELECT']}"
					itemValue="#{null}" />
				<f:selectItems var="tipoEjecucion" value="#{tiposCargue}"
					itemLabel="#{tipoEjecucion}" itemValue="#{tipoEjecucion}" />
				<p:column>
					<h:outputText value="#{t}" />
				</p:column>
				<p:ajax event="change" process="@this" update="@this" />
				<p:clientValidator />
			</p:selectOneMenu>
			<p:message for="tipoEjecucion" display="icon" />
		</p:panelGrid>
		<p:separator />
		<p:panelGrid columns="1" columnClasses="ui-grid-col-12" layout="grid"
			styleClass="ui-panelgrid-blank">
			<p:outputLabel value="${titles['TTL_ARCHIVOS']}" />
			<p:dataTable id="detalleArchivo" editable="true" reflow="true"
				rowKey="#{archivo.nombre}" value="#{plantillaBean.xml.archivo}"
				var="archivo" emptyMessage="${messages['DLG_SIN_REGISTROS']}"
				scrollable="true" scrollWidth="95%">

				<f:facet name="header">
					<h:outputText value="${titles['TTL_ARCHIVOS']}" />
				</f:facet>
				<p:column style="width:32px">
					<p:rowToggler />
				</p:column>
				<p:column style="width:48px">
					<p:commandButton icon="ui-icon-pencil" styleClass="botones-tabla"
						title="${titles['TTL_EDIT']}"
						actionListener="#{plantillaBean.editArchivo}" process="@this"
						update="@this detalleArchivo">
						<f:setPropertyActionListener value="#{archivo}"
							target="#{plantillaBean.archivoSeleccionado}" />
						<p:ajax event="dialogReturn" process="@this"
							listener="#{plantillaBean.seleccionarDetalle}"
							update="detalleArchivo" />
					</p:commandButton>
					<p:commandButton icon="ui-icon-trash" styleClass="botones-tabla"
						title="${titles['TTL_REMOVE']}" oncomplete="quitarArchivo()">
						<f:setPropertyActionListener value="#{archivo}"
							target="#{plantillaBean.archivoSeleccionado}" />
						<p:confirm header="${messages['DLG_CONFIRMACION']}"
							message="#{messages['MSG_PREGUNTA_ELIMINAR_REGISTRO'].concat(' ').concat(archivo.nombre).concat(' ').concat(archivo.mascara)}"
							icon="ui-icon-alert" />
					</p:commandButton>
					<p:remoteCommand name="quitarArchivo"
						actionListener="#{plantillaBean.quitarArchivo}"
						update="@this detalleArchivo" />
				</p:column>
				<p:column sortBy="#{archivo.orden}" sortable="true"
					headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_ORDEN_ARCHIVO']}"
					width="150">
					<h:outputText value="#{archivo.orden}" />
				</p:column>
				<p:column sortBy="#{archivo.nombre}"
					headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_NOMBRE_ARCHIVO']}"
					width="300">
					<h:outputText value="#{archivo.nombre}" />
				</p:column>
				<p:column
					headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_MASCARA']}"
					width="500">
					<h:outputText value="#{archivo.mascara}" />
				</p:column>
				<p:column
					headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_FORMATO_FECHA_ARCHIVO']}"
					width="100">
					<h:outputText value="#{archivo.formatoFechaArchivo}" />
				</p:column>
				<p:column
					headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_VERSION']}"
					width="80">
					<h:outputText value="#{archivo.version}" />
				</p:column>
				<p:column
					headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_EXTENSION']}"
					width="70">
					<h:outputText value="#{archivo.extension}" />
				</p:column>
				<p:column
					headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_TIPO_ARCHIVO']}"
					width="100">
					<h:outputText value="#{archivo.tipoArchivo}" />
				</p:column>
				<p:column
					headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_CALIFICADOR_LONG_NOMBRE']}"
					width="150">
					<h:outputText value="#{archivo.calificadorLongitudNombre}" />
				</p:column>
				<p:column
					headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_LONGITUD_NOMBRE']}"
					width="100">
					<h:outputText value="#{archivo.longitudNombre}" />
				</p:column>
				<p:column
					headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_CALIFICADOR_FECHA_ARCHIVO']}"
					width="150">
					<h:outputText value="#{archivo.calificadorFechaArchivo}" />
				</p:column>
				<p:column
					headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_CRUCE_ARCHIVO']}"
					width="100">
					<h:outputText value="#{archivo.cruceFechaArchivo}" />
				</p:column>
				<p:rowExpansion>
					<p:panelGrid columns="1" layout="grid"
						styleClass="ui-panelgrid-blank" columnClasses="ui-grid-col-12">
						<p:commandButton icon="ui-icon-plus"
							value="${titles['TTL_ADD_REGISTRO']}"
							actionListener="#{plantillaBean.addRegistro}" process="@this"
							update="@this">
							<f:setPropertyActionListener value="#{archivo}"
								target="#{plantillaBean.archivoSeleccionado}" />
							<p:ajax event="dialogReturn" process="@this"
								listener="#{plantillaBean.seleccionarDetalle}"
								update="detalleRegistro" />
						</p:commandButton>

						<p:dataTable id="detalleRegistro" var="registro" editable="true"
							reflow="true" rowKey="#{registro}" value="#{archivo.registro}"
							emptyMessage="${messages['DLG_SIN_REGISTROS']}">
							<f:facet name="header">
								<h:outputText value="${titles['TTL_REGISTROS']}" />
							</f:facet>
							<p:column style="width:32px">
								<p:rowToggler />
							</p:column>
							<p:column style="width:48px">
								<p:commandButton icon="ui-icon-pencil"
									styleClass="botones-tabla" title="${titles['TTL_EDIT']}"
									actionListener="#{plantillaBean.editRegistro}" process="@this"
									update="@this detalleRegistro">
									<f:setPropertyActionListener value="#{archivo}"
										target="#{plantillaBean.archivoSeleccionado}" />
									<f:setPropertyActionListener value="#{registro}"
										target="#{plantillaBean.registroSeleccionado}" />
									<f:setPropertyActionListener value="#{registro.SQL}"
										target="#{plantillaBean.sqlSeleccionada}" />
								</p:commandButton>
								<p:commandButton icon="ui-icon-trash" styleClass="botones-tabla"
									title="${titles['TTL_REMOVE']}" oncomplete="quitarRegistro()">
									<f:setPropertyActionListener value="#{registro}"
										target="#{plantillaBean.registroSeleccionado}" />
									<f:setPropertyActionListener value="#{archivo}"
										target="#{plantillaBean.archivoSeleccionado}" />
									<p:confirm header="${messages['DLG_CONFIRMACION']}"
										message="#{messages['MSG_PREGUNTA_ELIMINAR_REGISTRO'].concat(' ').concat(registro.descripcion)}"
										icon="ui-icon-alert" />
								</p:commandButton>
								<p:remoteCommand name="quitarRegistro"
									actionListener="#{plantillaBean.quitarRegistro}"
									update="@this detalleRegistro" />
							</p:column>
							<p:column
								headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_DESCRIPCION']}">
								<h:outputText value="#{registro.descripcion}" />
							</p:column>
							<p:column
								headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_CSV']}"
								style="width:70px">
								<h:outputText
									value="#{registro.csv ? titles['TTL_YES'] : titles['TTL_NO']}" />
							</p:column>
							<p:column
								headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_CARACTER_CSV']}"
								style="width:150px">
								<h:outputText value="#{registro.caracterCsv}" />
							</p:column>
							<p:column
								headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_TIPO_REGISTRO']}"
								style="width:150px">
								<h:outputText value="#{registro.tipoRegistro}" />
							</p:column>
							<p:column
								headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_REQUERIDO']}"
								style="width:70px">
								<h:outputText
									value="#{registro.requerido ? titles['TTL_YES'] : titles['TTL_NO']}" />
							</p:column>
							<p:column
								headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_CONTIENE_SQL']}"
								style="width:70px">
								<h:outputText
									value="#{registro.contieneSentenciaSQL ? titles['TTL_YES'] : titles['TTL_NO']}" />
							</p:column>
							<p:rowExpansion>
								<p:panelGrid columns="1" layout="grid"
									styleClass="ui-panelgrid-blank" columnClasses="ui-grid-col-12">
									<h:panelGroup rendered="#{registro.contieneSentenciaSQL}">
										<p:outputLabel for="sentencia"
											value="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_SQL']}: " />
										<h:outputText id="sentencia"
											placeholder="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_SQL']}"
											value="#{registro.SQL.sentencia}">
										</h:outputText>
										<p:message for="sentencia" display="icon" />
									</h:panelGroup>
									<p:commandButton icon="ui-icon-plus"
										rendered="#{registro.contieneSentenciaSQL}"
										value="${titles['TTL_ADD_PARAMETRO']}"
										actionListener="#{plantillaBean.addParametro}" process="@this"
										update="@this">
										<f:setPropertyActionListener value="#{archivo}"
											target="#{plantillaBean.archivoSeleccionado}" />
										<f:setPropertyActionListener value="#{registro}"
											target="#{plantillaBean.registroSeleccionado}" />
										<f:setPropertyActionListener value="#{registro.SQL}"
											target="#{plantillaBean.sqlSeleccionada}" />
										<p:ajax event="dialogReturn" process="@this"
											listener="#{plantillaBean.seleccionarDetalle}"
											update="detalleParametro" />
									</p:commandButton>
									<h:panelGroup rendered="#{registro.contieneSentenciaSQL}">
										<h:outputText style="float:right"
											value="${messages['MSG_INFO_TRANSVERSAL_PLANTILLA_XML_PARAMETRO']}" />
										<p:outputLabel value=" ${titles['TTL_NOTE']} : " />
									</h:panelGroup>
									<p:dataTable id="detalleParametro" editable="true"
										rendered="#{registro.contieneSentenciaSQL}" reflow="true"
										rowKey="#{parametro}" value="#{registro.SQL.parametro}"
										var="parametro"
										emptyMessage="${messages['DLG_SIN_REGISTROS']}">
										<f:facet name="header">
											<h:outputText value="${titles['TTL_PARAMETROS']}" />
										</f:facet>
										<p:column style="width:48px">
											<p:commandButton icon="ui-icon-pencil"
												styleClass="botones-tabla" title="${titles['TTL_EDIT']}"
												actionListener="#{plantillaBean.editParametro}"
												process="@this" update="@this detalleParametro">
												<f:setPropertyActionListener value="#{archivo}"
													target="#{plantillaBean.archivoSeleccionado}" />
												<f:setPropertyActionListener value="#{registro}"
													target="#{plantillaBean.registroSeleccionado}" />
												<f:setPropertyActionListener value="#{columna}"
													target="#{plantillaBean.columnaSeleccionada}" />
												<f:setPropertyActionListener value="#{registro.SQL}"
													target="#{plantillaBean.sqlSeleccionada}" />
												<f:setPropertyActionListener value="#{parametro}"
													target="#{plantillaBean.parametroSeleccionado}" />
												<p:ajax event="dialogReturn" process="@this"
													listener="#{plantillaBean.seleccionarDetalle}"
													update="detalleParametro" />
											</p:commandButton>
											<p:commandButton icon="ui-icon-trash"
												oncomplete="quitarParametro()" styleClass="botones-tabla"
												title="${titles['TTL_REMOVE']}">
												<f:setPropertyActionListener value="#{archivo}"
													target="#{plantillaBean.archivoSeleccionado}" />
												<f:setPropertyActionListener value="#{registro}"
													target="#{plantillaBean.registroSeleccionado}" />
												<f:setPropertyActionListener value="#{columna}"
													target="#{plantillaBean.columnaSeleccionada}" />
												<f:setPropertyActionListener value="#{registro.SQL}"
													target="#{plantillaBean.sqlSeleccionada}" />
												<f:setPropertyActionListener value="#{parametro}"
													target="#{plantillaBean.parametroSeleccionado}" />
												<p:confirm header="${messages['DLG_CONFIRMACION']}"
													message="#{messages['MSG_PREGUNTA_ELIMINAR_REGISTRO'].concat(' ').concat(parametro.nombre)}"
													icon="ui-icon-alert" />
											</p:commandButton>
											<p:remoteCommand name="quitarParametro"
												actionListener="#{plantillaBean.quitarParametro}"
												update="@this detalleParametro" />
										</p:column>
										<p:column sortBy="#{parametro.nombre}" sortable="true"
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_LLAVE']}">
											<h:outputText value="#{parametro.nombre}" />
										</p:column>
										<p:column sortBy="#{parametro.tipoDato}" sortable="true"
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_TIPO_DATO']}">
											<h:outputText value="#{parametro.tipoDato.value()}" />
										</p:column>
										<p:column sortBy="#{parametro.etiquetaColumna}"
											sortable="true"
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_ETIQUETA']}"
											rendered="#{tipoCargue eq PFTipoCargue.REPORTE}">
											<h:outputText value="#{parametro.etiquetaColumna}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_REQUERIDO']}"
											rendered="#{tipoCargue eq PFTipoCargue.REPORTE}">
											<h:outputText
												value="#{parametro.requerido ? titles['TTL_YES'] : titles['TTL_NO']}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_SENTENCIA']}"
											rendered="#{tipoCargue eq PFTipoCargue.REPORTE}">
											<h:outputText value="#{parametro.sentencia}" />
										</p:column>
									</p:dataTable>
									<p:commandButton id="botonMasColumna" icon="ui-icon-plus"
										value="${titles['TTL_ADD_COLUMNA']}"
										actionListener="#{plantillaBean.addColumna}" process="@this"
										update="@this">
										<f:setPropertyActionListener value="#{archivo}"
											target="#{plantillaBean.archivoSeleccionado}" />
										<f:setPropertyActionListener value="#{registro}"
											target="#{plantillaBean.registroSeleccionado}" />
										<p:ajax event="dialogReturn" process="@this"
											listener="#{plantillaBean.seleccionarDetalle}"
											update="detalleColumna" />
									</p:commandButton>
									<p:dataTable id="detalleColumna" var="columna" editable="true"
										rowKey="#{columna}" varStatus="status"
										value="#{registro.columna}"
										emptyMessage="${messages['DLG_SIN_REGISTROS']}">
										<p:column style="width:48px">
											<p:commandButton icon="ui-icon-pencil"
												styleClass="botones-tabla" title="${titles['TTL_EDIT']}"
												actionListener="#{plantillaBean.editColumna}"
												process="@this" update="@this detalleColumna">
												<f:setPropertyActionListener value="#{archivo}"
													target="#{plantillaBean.archivoSeleccionado}" />
												<f:setPropertyActionListener value="#{registro}"
													target="#{plantillaBean.registroSeleccionado}" />
												<f:setPropertyActionListener value="#{registro.SQL}"
													target="#{plantillaBean.sqlSeleccionada}" />
												<f:setPropertyActionListener value="#{columna}"
													target="#{plantillaBean.columnaSeleccionada}" />
												<p:ajax event="dialogReturn" process="@this"
													listener="#{plantillaBean.seleccionarDetalle}"
													update="detalleColumna" />
											</p:commandButton>
											<p:commandButton icon="ui-icon-trash"
												styleClass="botones-tabla" title="${titles['TTL_REMOVE']}"
												oncomplete="quitarColumna()">
												<f:setPropertyActionListener value="#{archivo}"
													target="#{plantillaBean.archivoSeleccionado}" />
												<f:setPropertyActionListener value="#{registro}"
													target="#{plantillaBean.registroSeleccionado}" />
												<f:setPropertyActionListener value="#{columna}"
													target="#{plantillaBean.columnaSeleccionada}" />
												<p:confirm header="${messages['DLG_CONFIRMACION']}"
													message="#{messages['MSG_PREGUNTA_ELIMINAR_REGISTRO'].concat(' ').concat(columna.descripcion)}"
													icon="ui-icon-alert" />
											</p:commandButton>
											<p:remoteCommand name="quitarColumna"
												actionListener="#{plantillaBean.quitarColumna}"
												update="@this detalleColumna" />
										</p:column>
										<f:facet name="header">
											<h:outputText
												value="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_COLUMNAS']}" />
										</f:facet>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_ORDEN']}">
											<h:outputText value="#{columna.orden}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_DESCRIPCION']}">
											<h:outputText value="#{columna.descripcion}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_ETIQUETA_COLUMNA']}">
											<h:outputText value="#{columna.etiquetaColumna}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_INICIO']}">
											<h:outputText value="#{columna.inicio}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_FIN']}">
											<h:outputText value="#{columna.fin}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_LONGITUD']}">
											<h:outputText
												value="#{columna.fin ne null and columna.fin gt 0 ? (columna.fin.add(columna.inicio ne null ? columna.inicio.negate() : -1).add(1)) : 1}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_MASCARA']}">
											<h:outputText value="#{columna.mascara}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_RENDERIZADO']}">
											<h:outputText
												value="#{columna.renderizado ? titles['TTL_YES'] : titles['TTL_NO']}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_REQUERIDO']}">
											<h:outputText
												value="#{columna.requerido ? titles['TTL_YES'] : titles['TTL_NO']}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_TIPO_DATO']}">
											<h:outputText value="#{columna.tipoDato}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_VALOR_DEFECTO']}">
											<h:outputText value="#{columna.valorPorDefecto}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_OBSERVACIONES']}">
											<h:outputText value="#{columna.observaciones}" />
										</p:column>
									</p:dataTable>
								</p:panelGrid>
							</p:rowExpansion>
						</p:dataTable>

						<p:commandButton icon="ui-icon-plus"
							value="${titles['TTL_ADD_VALIDACION']}"
							actionListener="#{plantillaBean.addValidacion}" process="@this"
							update="@this">
							<f:setPropertyActionListener value="#{archivo}"
								target="#{plantillaBean.archivoSeleccionado}" />
							<f:setPropertyActionListener value="#{registro}"
								target="#{plantillaBean.registroSeleccionado}" />
							<p:ajax event="dialogReturn" process="@this"
								listener="#{plantillaBean.seleccionarDetalle}"
								update="detalleValidacion" />
						</p:commandButton>

						<p:dataTable id="detalleValidacion" editable="true" reflow="true"
							rowKey="#{archivo.validacion}" value="#{archivo.validacion}"
							var="validacion" emptyMessage="${messages['DLG_SIN_REGISTROS']}">
							<f:facet name="header">
								<h:outputText value="${titles['TTL_VALIDACIONES']}" />
							</f:facet>
							<p:column style="width:32px">
								<p:rowToggler />
							</p:column>
							<p:column style="width:48px">
								<p:commandButton icon="ui-icon-pencil"
									styleClass="botones-tabla" title="${titles['TTL_EDIT']}"
									actionListener="#{plantillaBean.editValidacion}"
									process="@this" update="@this detalleValidacion">
									<f:setPropertyActionListener value="#{archivo}"
										target="#{plantillaBean.archivoSeleccionado}" />
									<f:setPropertyActionListener value="#{validacion}"
										target="#{plantillaBean.validacionSeleccionada}" />
									<p:ajax event="dialogReturn" process="@this"
										listener="#{plantillaBean.seleccionarDetalle}"
										update="detalleValidacion" />
								</p:commandButton>
								<p:commandButton icon="ui-icon-trash" styleClass="botones-tabla"
									oncomplete="quitarValidacion()" title="${titles['TTL_REMOVE']}">
									<f:setPropertyActionListener value="#{archivo}"
										target="#{plantillaBean.archivoSeleccionado}" />
									<f:setPropertyActionListener value="#{validacion}"
										target="#{plantillaBean.validacionSeleccionada}" />
									<p:confirm header="${messages['DLG_CONFIRMACION']}"
										message="#{messages['MSG_PREGUNTA_ELIMINAR_REGISTRO'].concat(' ').concat(validacion.tipoValidacion)}"
										icon="ui-icon-alert" />
								</p:commandButton>
								<p:remoteCommand name="quitarValidacion"
									actionListener="#{plantillaBean.quitarValidacion}"
									update="@this detalleValidacion" />
							</p:column>
							<p:column
								headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_VALIDAR']}">
								<h:outputText
									value="#{validacion.validar ? titles['TTL_YES'] : titles['TTL_NO']}" />
							</p:column>
							<p:column sortBy="#{validacion.tipoValidacion}" sortable="true"
								headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_TIPO_VALIDACION']}">
								<h:outputText value="#{validacion.tipoValidacion}" />
							</p:column>
							<p:column
								headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_TRANSACCIONAL']}">
								<h:outputText
									value="#{validacion.transaccional ? titles['TTL_YES'] : titles['TTL_NO']}" />
							</p:column>
							<p:column
								headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_NOTIFICAR']}">
								<h:outputText
									value="#{validacion.notificacion.notificar ? titles['TTL_YES'] : titles['TTL_NO']}" />
							</p:column>
							<p:column
								headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_PERSISTIDO']}">
								<h:outputText
									value="#{validacion.persistido ? titles['TTL_YES'] : titles['TTL_NO']}" />
							</p:column>
							<p:column
								headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_DESDE']}">
								<h:outputText value="#{validacion.notificacion.desde}" />
							</p:column>
							<p:rowExpansion>
								<p:panelGrid columns="1" layout="grid"
									styleClass="ui-panelgrid-blank" columnClasses="ui-grid-col-12">
									<p:outputLabel
										value="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_ASUNTO']}" />
									<h:outputText value="#{validacion.notificacion.asunto}" />
									<p:outputLabel
										value="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_CUERPO']}" />
									<h:outputText value="#{validacion.notificacion.cuerpo}"
										escape="false" />
									<p:separator />
									<p:commandButton icon="ui-icon-plus"
										value="${titles['TTL_ADD_CUENTA_CORREO']}"
										actionListener="#{plantillaBean.addCuentaCorreo}"
										process="@this" update="@this">
										<f:setPropertyActionListener value="#{archivo}"
											target="#{plantillaBean.archivoSeleccionado}" />
										<f:setPropertyActionListener value="#{validacion}"
											target="#{plantillaBean.validacionSeleccionada}" />
										<p:ajax event="dialogReturn" process="@this"
											listener="#{plantillaBean.seleccionarDetalle}"
											update="detalleCuentaCorreo" />
									</p:commandButton>
									<p:dataTable id="detalleCuentaCorreo" editable="true"
										rendered="#{validacion.notificacion.notificar}" reflow="true"
										rowKey="#{cuentaCorreo}"
										value="#{validacion.notificacion.cuentaCorreo}"
										var="cuentaCorreo"
										emptyMessage="${messages['DLG_SIN_REGISTROS']}">
										<f:facet name="header">
											<h:outputText value="${titles['TTL_NOTIFICACIONES']}" />
										</f:facet>
										<p:column style="width:48px">
											<p:commandButton icon="ui-icon-pencil"
												styleClass="botones-tabla" title="${titles['TTL_EDIT']}"
												actionListener="#{plantillaBean.editCuentaCorreo}"
												process="@this" update="@this detalleCuentaCorreo">
												<f:setPropertyActionListener value="#{archivo}"
													target="#{plantillaBean.archivoSeleccionado}" />
												<f:setPropertyActionListener value="#{validacion}"
													target="#{plantillaBean.validacionSeleccionada}" />
												<f:setPropertyActionListener value="#{cuentaCorreo}"
													target="#{plantillaBean.cuentaCorreoSeleccionada}" />
												<p:ajax event="dialogReturn" process="@this"
													listener="#{plantillaBean.seleccionarDetalle}"
													update="detalleCuentaCorreo" />
											</p:commandButton>
											<p:commandButton icon="ui-icon-trash"
												oncomplete="quitarCuentaCorreo()" styleClass="botones-tabla"
												title="${titles['TTL_REMOVE']}">
												<f:setPropertyActionListener value="#{archivo}"
													target="#{plantillaBean.archivoSeleccionado}" />
												<f:setPropertyActionListener value="#{validacion}"
													target="#{plantillaBean.validacionSeleccionada}" />
												<f:setPropertyActionListener value="#{cuentaCorreo}"
													target="#{plantillaBean.cuentaCorreoSeleccionada}" />
												<p:confirm header="${messages['DLG_CONFIRMACION']}"
													message="#{messages['MSG_PREGUNTA_ELIMINAR_REGISTRO'].concat(' ').concat(cuentaCorreo.nombreCuenta)}"
													icon="ui-icon-alert" />
											</p:commandButton>
											<p:remoteCommand name="quitarCuentaCorreo"
												actionListener="#{plantillaBean.quitarCuentaCorreo}"
												update="@this detalleCuentaCorreo" />
										</p:column>
										<p:column rendered="#{not empty cuentaCorreo.porPerfil}"
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_PERFIL']}">
											<h:outputText value="#{cuentaCorreo.porPerfil}" />
										</p:column>
										<p:column rendered="#{empty cuentaCorreo.porPerfil}"
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_NOMBRE_CUENTA']}">
											<h:outputText value="#{cuentaCorreo.nombreCuenta}" />
										</p:column>
										<p:column
											headerText="${titles['LBL_TRANSVERSAL_PLANTILLA_XML_TIPO_BANDEJA']}">
											<h:outputText value="#{cuentaCorreo.bandeja}" />
										</p:column>
									</p:dataTable>
								</p:panelGrid>
							</p:rowExpansion>
						</p:dataTable>
					</p:panelGrid>
				</p:rowExpansion>
			</p:dataTable>
		</p:panelGrid>
	</ui:define>
	<ui:define name="botones">
		<p:commandButton value="${titles['TTL_EDIT']}" icon="ui-icon-disk"
			process="@this contains" update="contains"
			action="#{plantillaBean.update}" />
		<p:commandButton id="botonMasArchivo" icon="ui-icon-plus"
			value="${titles['TTL_ADD_ARCHIVO']}"
			actionListener="#{plantillaBean.addArchivo}" process="@this"
			update="@this">
			<p:ajax event="dialogReturn" process="@this"
				listener="#{plantillaBean.seleccionarDetalle}"
				update="detalleArchivo" />
		</p:commandButton>
	</ui:define>
</ui:composition>
