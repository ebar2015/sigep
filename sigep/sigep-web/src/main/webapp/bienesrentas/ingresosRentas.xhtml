<ui:composition
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">
	<h:form id="formularioIngresosRenta">
		<div
			class="row row-background-white"
			style="margin-left: 0px; padding-top: 2em;">
			<ui:include src="tarjetaInformacionDeclaracion.xhtml" />
			<div
				class="row"
				style="padding-bottom: 1em !important">
				<div
					class="col-md-12"
					align="center">
					<p:outputLabel
						value="#{titles.TTL_BR_INGRESOS}"
						styleClass="advisor" />
				</div>
			</div>
			<hr class="hr-style" />
			<div class="row">
				<div class="col-md-12" style="text-align: right;">
					<div style="padding-right: 1%; display: inline-block">
						<p:commandButton id="btnNuevo"
							ajax="true" process="@this"
							styleClass="btn btn-transparent"
							actionListener="#{bienesRentasBean.crearIngreso()}"
							value="#{titles.LBL_ADD_NEW}"
							onclick="verFormularioIngresosRenta();"
							icon="fa fa-fw fa-plus-circle"
							disabled="#{bienesRentasBean.sinIngresosRentas}"
							update="tabViewBienesRentas:formularioIngresosRenta:panelFormularioIngresoLaboral"
							/>
					</div>
					<div
						class="col-md-6"
						align="right">
						
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-12">
					<div descr="aligVal2" class="col-md-12">
						<p:dataTable 
							id="tablaIngresosRenta"
							var="dataIngresosTabla"
							value="#{bienesRentasBean.listaIngresosDeclaracion}"
							paginator="true" 
							rows="#{paginatorSize}"
							rowsPerPageTemplate="#{paginatorsSize}"
							reflow="true"
							emptyMessage="${titles['TTL_BIENES_RENTAS_TABLA_SIN_REGISTROS']}"
							currentPageReportTemplate="{currentPage} ${titles['LBL_DE']} {totalPages}"
							paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
							>
							
							<p:column
								headerText="#{titles.TTL_BR_TAP_INGRESOS_RENTAS}"
								style="word-wrap: break-word!important;"
								sortBy="#{dataIngresosTabla.nombreTipoIngreso}">
								<p:outputLabel value="#{dataIngresosTabla.nombreTipoIngreso}" />
							</p:column>
							<p:column
								headerText="#{titles.LBL_PARAMETRICA_VALOR}"
								style="word-wrap: break-word!important;"
								sortBy="#{dataIngresosTabla.valor}">
								<p:outputLabel value="#{dataIngresosTabla.valor}">
									<f:convertNumber
										currencySymbol="$"
										type="currency"
										locale="es_CO"
										groupingUsed="true" />
								</p:outputLabel>
							</p:column>
							<p:column
								headerText="#{titles.LBL_TABLA_ACCIONES}"
								style="word-wrap: break-word!important; text-align:center!important;">
								<p:commandButton
									title="#{titles.TTL_EDIT}"
									icon="icon-edit"
									styleClass="icon-btn"
									process="@this"
									update="tabViewBienesRentas:formularioIngresosRenta"
									action="#{bienesRentasBean.mostrarDialogoEditarIngresoLaboral()}">
									<f:setPropertyActionListener
										value="#{dataIngresosTabla}"
										target="#{bienesRentasBean.ingresosDeclaracion}" />
								</p:commandButton>
								<p:commandButton
									title="#{titles.TTL_DELETE}"
									process="@this"
									icon="icon-delete"
									styleClass="icon-btn"
									update="tabViewBienesRentas:formularioIngresosRenta"
									action="#{bienesRentasBean.mostrarDialogoEliminarIngresoLaboral()}">
									<f:setPropertyActionListener
										value="#{dataIngresosTabla}"
										target="#{bienesRentasBean.ingresosDeclaracion}" />
								</p:commandButton>
							</p:column>
						</p:dataTable>
					</div>
				</div>
			</div>
			<div class="row" align="right">
				<div class="col-md-12" align="right" style="margin-top: 1%;">
					<div class="col-md-4"></div>
					<div class="col-md-3"></div>
					<div class="col-md-5" align="left" style="opacity: 1 !important;">
						<p:outputLabel value="#{titles.TTL_BIENES_RENTAS_TOTAL}" styleClass="log-label form-label" style="color: #3b7c9d!important; margin-left: 1%;" />
						<p:outputLabel disabled="true" id="valorTotalIngresosL" 
						value="$#{bienesRentasBean.valorTotalIngresos}" 
						style="color: #3b7c9d!important; margin-left: 1%;" styleClass="log-label form-label" />
					</div>
				</div>
			</div>
			<div class="row" align="center">
				<div class="col-md-12">
					<h:outputText styleClass="log-label form-label-formularios" value="${titles['TTL_BR_CHK_NO_INGRESOS']}" style="color: #00537B" />
					<p:spacer width="5" />
					<p:selectBooleanCheckbox id="chkSinIngresos" value="#{bienesRentasBean.sinIngresosRentas}" >
						<p:ajax listener="#{bienesRentasBean.guardarVerificacionIngresos}" process="@this" 
						update="btnNuevo" />
					</p:selectBooleanCheckbox>
				</div>
			</div>
			<br />
			<div class="col-md-12" align="center">
				<div class="col-md-4"></div>
				<div class="col-md-2"	style="margin-bottom: 3%;">
					<p:commandButton disabled="#{bienesRentasBean.btnGuardarIngresoRentaDeshabilitado}" title="#{bienesRentasBean.btnGuardarIngresoRentaMensaje}"
						value="#{titles.LBL_SAVE_CONT}" styleClass="btn btn-primary" style="font-size:1.5em!important; padding-top:0!important;" process="@this"
						actionListener="#{bienesRentasBean.guardarContinuarIngresoLaboral}" />
				</div>
				<div class="col-md-2" style="margin-bottom: 3%;">
					<p:commandButton value="#{titles.TTL_CANCEL}" type="button" onclick="mostrarDialogCancelarIR()" styleClass="btn btn-default"
						style="padding-left:12.5%!important;padding-right:12.5%!important; font-size:1.5em!important; padding-top:0!important;"/>
				</div>
				<div class="col-md-4"></div>
			</div>
		</div>
		<script type="text/javascript">
		function verFormularioIngresosRenta() {
			$("#divFormularioIngresoLaboral").attr("style", "display:block");
		}
		function verFormularioEditarIngresosRenta() {
			$("#divFormularioIngresoLaboral").attr("style", "display:block");
			$('#dialogEditarIngresosRenta').modal('hide');
		}
		function mostrarDialogCancelarIR(){			
			$('#dialogCancelarIngresoRenta').modal({
				backdrop : 'static',
				keyboard : false
			});
		}
		function volverInicio(){
			location.href='../bienesrentas/informacionPersona.xhtml'; 
			$('#dialogCancelarIngresoRenta').modal('hide');
		}
	</script>
		<br />
		<br />
		<div
			id="divFormularioIngresoLaboral"
			class="row row-background-white"
			style="display: none;">
			<p:panel id="panelFormularioIngresoLaboral" visible="#{bienesRentasBean.lbMostrarFormulario}">
				<br />
				<br />
				<hr class="hr-style hr-style-two" />
				<span class="span-style">#{titles.LBL_NEW_INGRESO}</span>
				<div
					class="row"
					align="right">
					<div class="col-md-12">
						<label class="form-label-formularios">${titles['TTL_REQUIRED']}</label>
					</div>
				</div>
				<div class="row">
					<div class="col-lg-12">
						<div class="col-md-2"></div>
						<div class="col-md-4">
							<p:outputLabel
								for="selectTipoIngresoR"
								value="#{titles.LBL_TIPO_INGRESO}:"
								styleClass="log-label form-label-formularios display-block" />
							<p:selectOneMenu
								id="selectTipoIngresoR"
								title="${titles['TTL_SELECT']} ${titles['LBL_TIPO_INGRESO']}"
								value="#{bienesRentasBean.ingresosDeclaracion.codTipoIngreso}"
								required="true" requiredMessage="${messages['DLG_VALOR_REQUERIDO']}"
								filter="true" filterMatchMode ="contains"
								disabled="#{!bienesRentasBean.lbEditarFormulario}"
								styleClass="form-control-form-act-usua">
								<f:selectItem
									itemLabel="#{titles.TTL_SELECT}" itemValue="#{null}" />
								<f:selectItems value="#{webUtils.tipoIngresoBR}" />
							</p:selectOneMenu>
							<p:message
								for="selectTipoIngresoR"
								display="text" />
						</div>
						<div class="col-md-4">
							<p:outputLabel
								value="#{titles.LBL_PARAMETRICA_VALOR} ($):"
								for="txtValorIngresoRenta"
								styleClass="log-label form-label-formularios display-block" />
								
								<p:inputNumber
								id="txtValorIngresoRenta"
								required="true"
								converterMessage="El valor debe ser numérico y la parte decimal separada por punto"
								requiredMessage="${messages['DLG_VALOR_REQUERIDO']}"
								validatorMessage="Debe ingresar un valor entre 0.1 y 9999999999999999"
								title="${titles['TTL_INGRESE']} ${titles['LBL_PARAMETRICA_VALOR444']} ${titles['TTL_TIPO_NUMERICO']}"
								value="#{bienesRentasBean.ingresosDeclaracion.valor}"
								onkeyup="return validateKey(event);"
								onkeydown="return validateKey(event);"
								onkeypress="return validateKey(event);"		
								symbol="$ "
								decimalSeparator=","
								thousandSeparator="."
								decimalPlaces="2"
								disabled="#{!bienesRentasBean.lbEditarFormulario}">
								<f:validateDoubleRange minimum="0.1" maximum="9999999999999999" />
							</p:inputNumber>
							<p:keyFilter for="txtValorIngresoRenta" mask="num"/>
							<p:message
								for="txtValorIngresoRenta"
								display="text" />
						</div>
						<script>
							function validateKey(event){
								if(event.which == 13 || event.keyCode == 13){
									event.stopPropagation();
									event.preventDefault();
									document.getElementById("tabViewBienesRentas:formularioIngresosRenta:btnGuardarIngresoRenta").focus();
									return false;
								}
							}
						</script>
						<div class="col-md-2"></div>
					</div>
				</div>
				<br />
				<br />
				<div class="col-md-12" align="center">
					<div class="col-md-3"></div>
					<div class="col-md-3" style="margin-bottom: 3%;">
						<p:commandButton
							id="btnGuardarIngresoRenta"
							value="${titles['TTL_BR_BTN_ADICIONAR']}"
							update="panelFormularioIngresoLaboral tablaIngresosRenta valorTotalIngresosL"
							process="formularioIngresosRenta"
							actionListener="#{bienesRentasBean.guardarIngresoLaboralRentas}"
							disabled="#{!bienesRentasBean.lbEditarFormulario}"
							styleClass="btn btn-primary"
							style="font-size:1.5em!important; padding-top:0!important;" />
					</div>
					<div class="col-md-3" style="margin-bottom: 3%;">
						<p:commandButton value="${titles['TTL_CLEAN']}" 
							styleClass="btn btn-primary" style="font-size:1.5em!important; 
							padding-top:0!important;" 
							process="@this"
							update="panelFormularioIngresoLaboral tablaIngresosRenta valorTotalIngresosL"
							actionListener="#{bienesRentasBean.limpiarIngresosRentas()}" 
							title="#{bienesRentasBean.strToolTipBtnLimpiar}"
							disabled="#{!bienesRentasBean.lbEditarFormulario}">
							<p:resetInput
										target="tabViewBienesRentas:formularioIngresosRenta:panelFormularioIngresoLaboral" />	
						</p:commandButton>
					</div>					
					<div class="col-md-3"></div>
				</div>
			</p:panel>
			<br />
		</div>
	</h:form>
	<div class="modal fade" id="dialogRespuIngresos" role="dialog"  data-backdrop="static"  data-keyboard="false" >
		<div class="modal-dialog modal-dialog-2" style="top: 18%; width: 55%;">
			<div class="modal-content">
				<!-- Modal body -->
				<div class="modal-body">
					<div class="row">
						<div class="col-md-12" align="center">
							<h5>
								<p:outputLabel value="${titles['TTL_BR_BORRAR_TODO']}" style="color: #265379!important; font-weight: normal!important; text-align: center;" />
							</h5>
						</div>
					</div>
					<hr class="hr-style-modales" />
					<div
						class="row"
						align="center">
						<div class="col-md-3"></div>
						<div class="col-md-3">
							<p:commandButton
								id="btnDeshabiTablaIngresos"
								value="${titles['TTL_OK']}"
								process="@this"
								styleClass="btn btn-primary"
								update="tabViewBienesRentas:formularioIngresosRenta"
								actionListener="#{bienesRentasBean.limpiarFormIngresosRenta()}"
								onclick="$('#dialogRespuIngresos').modal('hide')" />
						</div>
						<div class="col-md-3">
							<p:commandButton
								value="${titles['TTL_CANCEL']}"
								process="@this"
								styleClass="btn btn-default"
								actionListener="#{bienesRentasBean.cancelarEliminacionTablaIngresos()}"
								update="tabViewBienesRentas:formularioIngresosRenta:btnNuevo tabViewBienesRentas:formularioIngresosRenta:chkSinIngresos"
								onclick="$('#dialogRespuIngresos').modal('hide')" />
						</div>
						<div class="col-md-3"></div>
					</div>
					<br />
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" id="dialogEditarIngresosRenta" role="dialog" data-backdrop="static" data-keyboard="false">
		<div class="modal-dialog modal-dialog-2" style="top: 25%; width: 34.5%;">
			<div class="modal-content">
				<div class="modal-body">
					<div class="row">
						<div class="col-md-12" align="center">
							<h5>
								<p:outputLabel value="¿Señor usuario está seguro de modificar o editar el registro?" style="color: #265379!important; font-weight: normal!important; text-align: center;" />
							</h5>
						</div>
					</div>
					<hr class="hr-style-modales" />
					<div class="row">
						<div class="col-md-12">
							<div class="col-md-3"></div>
							<div class="col-md-3" align="center" style="margin-bottom: 3%;">
								<p:commandButton value="${titles['TTL_YES']}" type="button" 
								onclick="verFormularioEditarIngresosRenta();window.location.href='#tabViewBienesRentas:formularioIngresosRenta:panelFormularioIngresoLaboral_content'" 
								styleClass="btn btn-primary"
									style="padding-left:45%!important;padding-right:45%!important;font-size:1.5em!important; padding-top:0!important;">
								</p:commandButton>
							</div>
							<div class="col-md-3" align="center">
								<p:commandButton value="${titles['TTL_NO']}" styleClass="btn btn-default" type="button" onclick="$('#dialogEditarIngresosRenta').modal('hide');"
									style="padding-left:45%!important;padding-right:45%!important;font-size:1.5em!important; padding-top:0!important;">
								</p:commandButton>
							</div>
							<div class="col-md-3"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" id="dialogEliminarIngresosRenta" role="dialog" data-backdrop="static" data-keyboard="false">
		<div class="modal-dialog modal-dialog-2" style="top: 25%; width: 34.5%;">
			<div class="modal-content">
				<div class="modal-body">
					<div class="row">
						<div class="col-md-12" align="center">
							<h5>
								<p:outputLabel value="${titles['LBL_BR_ELIMINA_CUENTA']}" style="color: #265379!important; font-weight: normal!important; text-align: center;" />
							</h5>
						</div>
					</div>
					<hr class="hr-style-modales" />
					<div class="row">
						<div class="col-md-12">
							<div class="col-md-3"></div>
							<div
								class="col-md-3"
								align="center"
								style="margin-bottom: 3%;">
								<p:commandButton
									value="${titles['TTL_YES']}"
									styleClass="btn btn-primary"
									update="tabViewBienesRentas:formularioIngresosRenta"
									actionListener="#{bienesRentasBean.eliminarIngresoLaboralRentas}"
									style="padding-left:45%!important;padding-right:45%!important;font-size:1.5em!important; padding-top:0!important;">
								</p:commandButton>
							</div>
							<div
								class="col-md-3"
								align="center">
								<p:commandButton
									value="${titles['TTL_NO']}"
									styleClass="btn btn-default"
									type="button"
									onclick="$('#dialogEliminarIngresosRenta').modal('hide');"
									style="padding-left:45%!important;padding-right:45%!important;font-size:1.5em!important; padding-top:0!important;">
								</p:commandButton>
							</div>
							<div class="col-md-3"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div
		class="modal fade"
		id="dialogCancelarIngresoRenta"
		role="dialog" data-backdrop="static" data-keyboard="false">
		<div
			class="modal-dialog modal-dialog-2"
			style="top: 25%; width: 34.5%;">
			<div class="modal-content">
				<div class="modal-body">
					<div class="row">
						<div
							class="col-md-12"
							align="center">
							<h5>
								<p:outputLabel
									value="${messages['BR_DIALOGO_CANCELAR']}"
									style="color: #265379!important; font-weight: normal!important; text-align: center;" />
							</h5>
						</div>
					</div>
					<hr class="hr-style-modales" />
					<div class="row">
						<div class="col-md-12">
							<div class="col-md-3"></div>
							<div
								class="col-md-3"
								align="center"
								style="margin-bottom: 3%;">
								<p:commandButton
									value="${titles['TTL_YES']}"
									styleClass="btn btn-primary"
									actionListener="#{bienesRentasBean.cancelarFormularioIngresoLaboral}"
									style="padding-left:45%!important;padding-right:45%!important;font-size:1.5em!important; padding-top:0!important;">
								</p:commandButton>
							</div>
							<div
								class="col-md-3"
								align="center">
								<p:commandButton
									value="${titles['TTL_NO']}"
									styleClass="btn btn-default"
									onclick="$('#dialogCancelarIngresoRenta').modal('hide');"
									style="padding-left:45%!important;padding-right:45%!important;font-size:1.5em!important; padding-top:0!important;">
								</p:commandButton>
							</div>
							<div class="col-md-3"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
</ui:composition>